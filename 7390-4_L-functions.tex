% !TEX root = 7390-notes.tex





\section{Birch and Swinnerton-Dyer conjecture}

Consider an elliptic curve $E$ over $\dQ$. It has a model of the form 
$y^2=x^3+a x+b$ with $a,b\in \dZ$ and the discriminant 
$\Delta=-16(4 a^3+27 b^2)\ne 0$. The Mordell-Weil theorem (proved in this case 
by Mordell) tells us that $E(\dQ)$ is finitely generated. By basic algebra, 
we can write $E(\dQ) = E(\dQ)_\text{tors}\oplus \dZ^r$ where 
$E(\dQ)_\text{tors}$ is finite, and $r=\rank E(\dQ)$ is the algebraic rank of 
$E$ (over $\dQ$). The group $E(\dQ)_\text{tors}$ can be computed. One way is to 
look at the map $E(\dQ)_\text{tors}\to E(\dF_p)\times E(\dF_{p'})$, which is 
injective when $p$ and $p'$ are distinct primes of good reduction. For 
example, we could choose $p\ne p'$, with both not dividing $\Delta$. 

The group $E(\dQ)$ is one of a finite list. In fact, there is the following 
deep theorem of Mazur (conjectured by Ogg).

\begin{theorem}
Let $E$ be an elliptic curve over $\dQ$. Then $E(\dQ)_\textnormal{tors}$ is 
isomorphic to one of the following:
\[
  \begin{array}{ll}
    \dZ/n & \text{with $n=1,\dots,10$ or $n=12$} \\
    \dZ/n\oplus \dZ/2 & \text{with $n=1,\dots,4$}
  \end{array}
\]
\end{theorem}
\begin{proof}
See \cite[III.5.1]{ma77}. Essentially, Mazur classifies rational points on the 
modular curves $X_0(N)$. 
\end{proof}

Each of these possibilities occur infinitely often. An analogous theorem holds 
over any number field. More precisely, for each integer $d$, there is a global 
bound $B(d)$ such that for any elliptic curve $E$ over a number field $k$ with 
$[k:\dQ]=d$, one has $\# E(k)_\text{tors} \leqslant B(d)$. This is proven in 
\cite{me96}. For $k$ quadratic over $\dQ$, the possible groups 
$E(k)_\text{tors}$ have been classified. 

Unlike the situation with $E(\dQ)_\text{tors}$, where everything is computable 
and well-understood, there is no known algorithm to compute the rank of an 
elliptic curve. If $\sha(E)$ is finite, then there is an algorithm, but the 
finiteness of $\sha(E)$ is not known in general. 

The vague idea of the Birch and Swinnerton-Dyer conjecture (henceforth BSD) is 
as follows. Suppose $E(\dQ)$ has high rank. Then for $p$ a prime of good 
reduction, we have a map $E(\dQ) \to E(\dF_p)$. (Scheme-theoretically, 
$E(\dF_p)$ doesn't make sense. We set $E(\dF_p) = \cE(\dF_p)$, where 
$\cE$ is the N\'eron model of $E$ over $\dZ_{(p)}$. Since 
$E(\dQ) = E(\dZ)$, we are really looking at the map 
$E(\dZ) \to \cE(\dF_p)$.) The group $E(\dF_p)$ has order 
$p+1-a_p(E)$, where $a_p(E) = a(\cE_{\dF_p})$, and 
$|a_p(E)|\leqslant 2\sqrt p$. The expectation is for $E(\dF_p)$ to be 
``slightly larger'' than average, given that the map 
$E(\dQ) \to E(\dF_p)$ gives us some points ``for free.'' This effect turns out 
to be very subtle. 




\subsection{\texorpdfstring{$L$}{L}-functions of elliptic curves}

Define the function $\pi_E$ on $\dR_{\geqslant 0}$ by 
\[
  \pi_E(x) = \prod_{p\leqslant x \text{ good}} \frac{\# E(\dF_p)}{p} \text{.}
\]
We hope that $r=\rank E$ can be detected from the growth of $\pi_E$. In the 
early 60s, Swinnerton-Dyer used a computer to get numerical data on these 
types of problem. He and Birch conjectured the following \cite[A]{bsd65}: 
\[
  \lim_{x\to \infty} \frac{\log \pi_E(x)}{\log \log x} = r
\]
One could also conjecture that $\pi_E(X) \sim C (\log x)^r$ as $x\to \infty$ 
for some constant $C$. The function $\pi_E$ is hard to work with. Instead, we 
will follow standard practice in number theory and introduce an $L$-function. 

\begin{definition}
Let $E$ be an elliptic curve over $\dQ$ with discriminant $\Delta$. The 
\emph{partial $L$-function of $E$} is 
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \frac{1}{1-a_p(E) p^{-s} + p^{1-2s}} \text{.}
\]
\end{definition}

Here, $s$ is a complex variable, but this product does converge on the whole 
complex plane. Recall that if $E$ is an elliptic curve over $\dF_p$, the 
characteristic polynomial of the Frobenius $\Phi_E$ acting on $T_\ell E$ is 
$t^2-a_p t + p$. The reverse of this is 
$\det(1-\Phi^\ast t,V_\ell E) = 1-a_p t + p t^2$. It follows that we could have 
defined 
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \frac{1}{\det(1-\Phi_{E,p}^\ast p^{-s}, \h^1(E_p,\dQ_\ell))}
\]
for some prime $\ell\mid \Delta$. There is a way of adding factors at the 
``bad primes'' dividing the discriminant of $E$. We will come back to that later. 

\begin{lemma}
The product defining $L_\Delta(E,s)$ converges absolutely for all $s\in \dC$ 
with $\Re s>\frac 3 2$. Moreover, $L_\Delta(E,s)$ is holomorphic on that 
region. 
\end{lemma}
\begin{proof}
The basic idea is to use the factorization 
$1-a_p t + p t^2 = (1-\omega_{p,1} t)(1-\omega_{p,2}t)$, where  
$|\omega_{p,i}| = p^{1/2}$ by the Weil conjectures. We can write  
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \left(1-\frac{\omega_{p,1}}{p^{1/2}} p^{1/2-s}\right)^{-1}\left( 1-\frac{\omega_{p,2}}{p^{1/2}} p^{1/2-s}\right)^{-1}
\]
Standard arguments (using only the fact that the $\omega_{p,i}$ are $p$-Weil) 
yield the result. 
\end{proof}

Following Euler, we look at $L_\Delta(E,1)$, (which does not exist unless 
$L_\Delta(E,s)$ has some kind of analytic continuation, which we have not 
proved). At least formally (ignoring convergence) we have 
\begin{align*}
  L_\Delta(E,1) &= \prod_{p\nmid \Delta} (1-a_p(E) p^{-1} + p^{-1})^{-1} \\
    &= \prod_{p\nmid \Delta} \frac{p}{p-a_p(E)+1} \\
    &= \prod_{p\nmid \Delta} \frac{p}{\# E(\dF_p)}
\end{align*}
This looks very similar to our definition of the function $\pi_E$. At least 
intuitively, larger $r$ should lead to ``quicker vanishing'' at $s=1$. 

\begin{conjecture}[Birch and Swinnerton-Dyer]
The function $L_\Delta(E,s)$ has an analytic continuation to a neighborhood of 
$s=1$. Moreover, 
\[
  \ord_{s=1} L_\Delta(E,s) = \rank E \text{.}
\]
\end{conjecture}

In other words, the conjecture says that $L_\Delta(E,s)\sim c(s-1)^r$ near 
$s=1$ for some constant $c$. Modern formulations of BSD include a formula for 
$c$. 

Let's define the factors in $L(E,s)$ for primes $p\mid \Delta$. The following 
seems quite ad-hoc without motivation:
%For such a 
%prime, $E$ will have a N\'eron model $\cE_p$ over $\dZ_{(p)}$, and the 
%reduction $(\cE_p)_{\dF_p}$ will either be smooth (good reduction), have a 
%cusp (additive reduction), or a double point (multiplicative reduction). In the 
%latter two cases, the nonsingular locus of $(\cE_p)_{\dF_p}$ is isomorphic (as 
%a group scheme) to $\dG_{a,\dF_p}$ and $\dG_{m,\dF_p}$ respectively. 
%We define the local factor by  
\[
  L_p(E,s)
    = \begin{cases}
        \displaystyle\frac{1}{1-a_p p^{-s} + p^{1-2 s}} & \text{if $E$ has good reduction at $p$}  \\
        \displaystyle\frac{1}{1-a_p p^{-s}} & \text{if $E$ has bad reduction at $p$} \\
  %      1-p^{-s} & \text{if $E$ has nonsplit multiplicative reduction at $p$} \\
  %      1+p^{-s} & \text{if $E$ has split multiplicative reduction at $p$}
      \end{cases}
\]
Here, $a_p=-1$ if $E$ has split multiplicative reduction at $p$, 
$a_p=1$ if $E$ has nonsplit multiplicative reduction, and $a_p=0$ if $E$ has 
additive reduction. 
% a_p=-1 if split, 1 if nonsplit, 0 if additive reduction
This terminology deserves some explanation. Fix a prime $p$. A \emph{minimal 
model} for $E$ at $p$ is an equation $y^2=x^3+a x+b$, where $a,b$ are integral 
over $\dZ_{(p)}$, and such that the descriminant $\Delta=-16(4 a^3+27 b^2)$ has 
minimal $p$-adic valuation among such models. Let $\widetilde E$ be a minimal 
model for $E$. Then $\widetilde E$ is a scheme over $\dZ_{(p)}$, so we can 
consider its reduction $\widetilde E_p=\widetilde E_{\dF_p}$ modulo $p$. If 
$E$ has bad reduction at $p$, $\widetilde E_p$ will be singular, but its 
nonsingular locus $\widetilde E_{p,\text{ns}}$ will be a smooth group scheme 
over $\dF_p$. There are three possibilities for $\widetilde E_{p,\text{ns}}$. 
Either it will be the additive group $\dG_{a,\dF_p}$, in which case we say 
$E$ has \emph{additive reduction at $p$}, or it will be a one-dimensional 
torus (isomorphic to $\dG_{\bar\dF_p}$ after base change). In the second 
case we say $E$ has \emph{split multiplicative reduction at $p$} if 
$\widetilde E_{p,\text{ns}}\simeq \dG_{m,\dF_p}$, and we say $E$ has 
\emph{nonsplit multiplicative reduction at $p$} if 
$\widetilde E_{p,\text{ns}}\not\simeq \dG_{m,\dF_p}$ (it turns out that 
we get isomorphism after base change to a quadratic extension of 
$\dF_p$). See \cite[III.2.5, 2.6]{si06} for a proof and details.  

%There is a way of defining the local factors for $L(E,s)$ that is more 
%conceptual. Let $\cE$ be the N\'eron model for $E$ over $\dZ$ (this exists by 
%\cite[1.4.3]{blr90}). One way of characterizing $\cE$ is by requiring 
%that it represent the functor $X\mapsto \hom(X_\dQ,E)$ on smooth varieties over 
%$\dZ$. In particular, $\cE$ is a smooth (but not projective) group scheme over 
%$\dZ$, so each $\cE_p=\cE_{\dF_p}$ is a group variety over $\dF_p$. If we write 
%$\cE_p^\circ$ for the connected component of the identity in $\cE_p$, then by 
%\cite[C.15.1, C.16]{si06}, one has 
%\[
%  a_p = p - \# \widetilde E_{p,\text{ns}}(\dF_p) = p - \# \cE_p^\circ(\dF_p) \text{.}
%\]
%This yields the following theorem.
%
%\begin{theorem}
%Let $E$ be an elliptic curve over $\dQ$, and let $\ell$ be a prime. Then for all 
%primes $p\ne \ell$, we have 
%\[
%  L_p(E,s) = \frac{1}{\det\left(1-\Phi_{p,\ast}\cdot p^{-s}, (T_\ell E)^{I_p}\right)} \text{.}
%\]
%\end{theorem}
%\begin{proof}
%Recall that $I_p\subset G_\dQ$ is the inertia subgroup at $p$. If $E$ has good 
%reduction at $p$, then the action of $G_\dQ$ on $T_\ell E$ is unramified at 
%$p$ (this is the N\'eron-Ogg-Shafarevich criterion, \cite[thm 1]{st68}). In 
%that case $T_\ell E \simeq T_\ell \cE_p$, and the result follows from our 
%computation in Section \ref{sec:ab-fin-fld} of the characteristic polynomial 
%of Frobenius over finite fields. In general, one has 
%\[
%  T_\ell\cE_p^\circ = (T_\ell E)^{I_p}\text{.}
%\]
%This is proven in \cite[IX.2.2]{gr72}. Since $T_\ell \cE_p^\circ$ has rank one 
%over $\dZ_\ell$, we just need to prove that $\Phi_{p,\ast}$ is multiplication 
%by $a_p$ on $T_\ell \cE_p^\circ$. \textbf{(not finished)}
%\end{proof}
%
%Much of this generalizes further. Let $k$ be a number field with ring of 
%integers $\fo$. Let $A$ be any abelian variety over $k$ with N\'eron model 
%$\cA$. For a prime $\fp$ of $\fo$, let $\kappa_\fp=\fo/\fp$ be the residue 
%field of $\fp$. The connected component $A_\fp^\circ$ of the reduction 
%$A_\fp = \cA_{\kappa_\fp}$ is a smooth commutative group variety over 
%$\kappa_\fp$. As such, it admits a maximal subtorus 
%$T\subset A_\fp^\circ$, such that the quotient $A_\fp^\circ/T$ is the extension 
%of an abelian variety by a unipotent group \cite[IX.2]{gr72}. One says 
%$A$ has \emph{good reduction} at a prime $\fp$ if $A_\fp^\circ$ is itself 
%abelian. On the other hand, if $A_\fp^\circ/T$ is abelian, the variety 
%$A_\fp^\circ$ is semi-abelian, so we say that $A$ has \emph{semistable 
%reduction at $\fp$}. If the subtorus of $A_\fp^\circ$ splits over $\kappa_\fp$ 
%we say that $A$ has \emph{split semistable reduction} at $\fp$, otherwise it 
%has \emph{nonsplit semistable reduction} at $\fp$. 
%For elliptic curves, semistable reduction is equivalent to multiplicative 
%reduction. 
%
%For each finite place $\fp$ of $k$, choose a prime $\ell$ not dividing $\fp$ 
%and put 
%\[
%  L_\fp(A,s) = \frac{1}{\det\left(1-\Phi_{\fp,\ast} \cdot (N\fp)^{-s}, (T_\ell A)^{I_\fp}\right)} \text{.}
%\]
%The global $L$-function of $A$ is the product of its local pieces:
%\[
%  L(A,s) = \prod_\fp L_\fp(A,s) \text{.}
%\]
%The \emph{Bloch-Kato conjecture} (which makes sense in much more generality -- 
%arbitrary pure motives) predicts the order of vanishing of 
%$L(A,s)$ at $1$, as well as the leading term in its Taylor expansion at 
%$1$. 
%

%Generally, 
%\[
%  L_p(E,1) = \frac{p}{\# E_{p,\text{ns}}(E_p)}
%\]





% lecture on 11-12-2013

\subsection{Conductors}

Let $E$ be an elliptic curve over $\dQ$ with rank $r$. The \emph{conductor} of 
$E$ is an integer measuring the how badly $E$ reduces over various primes. 
Before we can define the conductor, we need to recall some basic facts about 
Galois groups of local fields. Let $k$ be a local field, $L/k$ a finite Galois 
extension. Let $v$ be a valuation on $K$ normalized by the condition 
$v(\pi_L)=1$. Let $G=\gal(L/k)$. Then the \emph{higher ramification groups} of 
the extension $L/k$ are:
\[
  G_i = \{\sigma\in G : v(\sigma (x)-x) > i\text{ for all $x\in \fo_L$}\} \text{.}
\]
For example, $G_{-1}=G$, $G_0$ is the inertia subgroup of $L/k$, and $G_1$ is 
the ``wild inertia'' subgroup of $G$. The $G_i$ form an exhaustive descending 
filtration of $G$. For a careful study of the higher ramification groups, see 
\cite[IV]{se79}. 

The conductor of an elliptic curve $E$ over $\dQ$ is defined as a product of 
local data: $N = \prod_p p^{f_p}$. Each of the $f_p$ only depend on the base 
change $E_{\dQ_p}$. So, treat $E$ is an elliptic curve over $\dQ_p$, and 
choose a prime $\ell\ne p$. Let $V=E[\ell]$; this is a two-dimensional vector 
space over $\dF_\ell$ with an action of $G_{\dQ_p}$. Since $GL(V)$ is finite, 
the action of $G_{\dQ_p}$ factors through a finite quotient 
$G=\gal(L/\dQ_p)$. We define 
\[
  f_p(E) = \sum_{i\geqslant 0} \frac{1}{[G_0:G_i]} \dim_{\dF_\ell} V/V^{G_i} \text{.}
\]
Note that $G_0=I_p$, the inertia group at $p$, and $G_1=P_p$, the Sylow 
$p$-subgroup of $G$ (consisting of ``wild inertia''), see \cite[IV]{se79} for a 
proof. So we can split up the sum as 
\[
  f_p(E) = \dim_{\dF_\ell} V/V^{I_p} + \sum_{i\geqslant 1} \frac{1}{[G_0:G_i]} \dim_{\dF_\ell} V/V^{G_i} \text{.}
\]
The quantity $\dim V/V^{I_p}$ is called the \emph{tame part} of $f_p$, 
sometimes written $\varepsilon_p$, and the 
rest of the sum is called the \emph{wild part}, written $\delta_p$. If 
$p\geqslant 5$, the wild part is zero and there is an easy formula for $f_p$: 
\[
  f_p(E) 
    = \begin{cases}
        0 & \text{if $E$ has good reduction at $p$} \\
        1 & \text{if $E$ has multiplicative reduction at $p$} \\
        2 & \text{if $E$ has additive reduction at $p$} 
      \end{cases}
\]
See \cite[IV.10.2]{si94} for a proof of this. Sometimes $f_p$ is called the 
\emph{Swan conductor} of $E[\ell]$. 
%There is an easy way to compute 
%$f_p$ even when $p\leqslant 3$, called the \emph{Grothendieck-Ogg-Saito 
%formula}. 

\begin{theorem}\label{thm:L-cont}
The function $L(E,s)$ has an analytic continuation to all of $\dC$. Moreover, 
it satisfies a functional equation: there exists $\omega =\pm 1$ such that 
\[
  \Lambda(s) = \omega \Lambda(2-s)
\]
where $\Lambda(s) = N^{s/2} (2\pi)^{-s} \Gamma(s) L(E,s)$. 
\end{theorem}

The constants $N$ and $\omega$ are easily computed. They are a product of 
local factors, so in particular no analysis is needed to find their values. 

We can give a sketch of a proof of this theorem. Expand the product formula for 
$L(E,s)$ to get a Dirichlet series 
\[
  L(E,s) = \sum_{n\geqslant 1} \frac{a_n(E)}{n^s} \text{.}
\]
It is not immediately obvious that these $a_n=a_n(E)$ agree with our earlier 
definition of the $a_p=p+1-\# E(\dF_p)$. It follows from an argument similar to 
the one Euler used to prove the product formula for $\zeta(s)$. Moreover, we 
have $a_n\in \dZ$ for all $n$. The function 
$a\mapsto a_n$ is multiplicative in the number-theoretic sense: if 
$(m,n)=1$, then $a_{mn}=a_m a_n$. If $n\geqslant 2$, then 
\[
  a_{p^n} = a_p a_{p^{n-1}} - p a_{p^{n-2}} \text{.}
\]
This allows us to compute $a_n$ for any $n$ just using the $a_p$. Define the 
Fourier series 
\[
  f(z) = \sum_{n\geqslant 1} a_n q^n \qquad (q=e^{2\pi i z})
\]
where $z$ ranges over the upper half-plane $\fh=\{z\in \dC:\Im z>0\}$. 

\begin{theorem}[Fermat-Wiles]\label{thm:fermat-wiles}
Let $E$ be an elliptic curve over $\dQ$ with conductor $E$. Then the function 
$f=f_E$ defined above is a cusp form of weight $2$ and level $N$. Moreover, 
$f$ is an eigenform (eigenvector for all Hecke operators). 
\end{theorem}
\begin{proof}
See \cite{bcdt01} for a proof which relies heavily on previous work by 
Wiles (with help from Taylor).
\end{proof}
This is one version of the Taniyama-Shimura conjecture. We'll take a moment to 
explain everything in the theorem. 





\subsection{Modularity}

Recall that $\operatorname{SL}(2,\dR)$ acts 
on $\fh$ via fractional linear transformations:
\[
  \begin{pmatrix} a & b \\ c & d\end{pmatrix}\cdot z = \frac{a z+b}{c z+d} \text{.}
\]
There is nothing ad-hoc about this: the group scheme 
$\operatorname{GL}(n+1)$ acts on $\dP^n$ in the obvious way, and our action is 
just a restriction of the action of $\operatorname{GL}(2,\dC)$ on $\dP^1(\dC)$ 
to an action of $\operatorname{SL}(2,\dR)$ on $\fh\subset \dP^1(\dC)$. 
The space $\Omega^1(\fh)$ of (complex) holomorphic one-forms on $\fh$ consists of 
differentials $\eta=f(z)dz$. For 
$\gamma=\smat a b c d\in \operatorname{SL}(2,\dR)$, one easily computes 
\[
  \gamma^\ast \eta = f(\gamma z)d(\gamma z) = (c z+d)^{-2}f(\gamma z) dz \text{.}
\]

Let $N\geqslant 1$ be an integer, and let $\Gamma$ be one of the following 
groups:
\begin{align*}
  \Gamma_0(N) &= \left\{\gamma \in \operatorname{SL}(2,\dZ) : \gamma \equiv \begin{pmatrix} \ast & \ast \\ 0 & \ast \end{pmatrix} \mod N\right\} \\
  \Gamma_1(N) &= \left\{\gamma \in \operatorname{SL}(2,\dZ) : \gamma \equiv \begin{pmatrix} 1 & \ast \\ 0 & 1 \end{pmatrix} \mod N\right\} \text{.}
\end{align*}
We say a function $f:\fh\to \dC$ is a \emph{weak modular form} of weight $2$ 
for $\Gamma$ if it is holomorphic and $f(z)\, dz$ is invariant under the action 
of $\Gamma$. Explicitly, for for all matrices $\smat a b c d\in\Gamma$, we 
require: 
\[
  f\left(\frac{a z+b}{c z+d}\right) = (c z+d)^2 f(z) \text{.}
\]
The quotient 
$Y_\Gamma=\fh/\Gamma$ may be a non-compact orbifold, but there is a canonical 
way of removing the non-smooth points and compactifying (by adding finitely 
many ``cusps'') to arrive at a compact Riemann surface $X_\Gamma$. 
We say $f$ is a \emph{modular cusp form} of level $N$ and weight two if it descends 
to a holomorphic differential on $X_\Gamma$. For weight-two forms, 
the differential $f\,dz$ automatically vanishes on the cusps of $X_\Gamma$. 
For details, see \cite{ds05}, or \cite[XI.11]{kn92} for the case 
$\Gamma=\Gamma_0(N)$. One writes $X_0(N)$, and $X_1(N)$ for 
$X_{\Gamma_0(N)}$ and $X_{\Gamma_1(N)}$, and calls these \emph{modular curves}. 
If we write $S_2(\Gamma)$ for the space of weight-two modular forms of level 
$\Gamma$, then by definition we have equality
\[
  S_2(\Gamma) = \h^0(X_\Gamma,\Omega^1) \text{.}
\]

Modular curves have a moduli-theoretic interpretation. There are canonical 
bijections \cite[1.5]{ds05}:
\begin{align*}
  X_0(N) &\simeq \{(E,C):\text{$E$ a complex torus and $C\subset E$ cyclic of order $N$}\}/\sim  \\
  X_1(N) &\simeq \{(E,P):\text{$E$ a complex torus and $P\in E$ of order $N$}\}/\sim \text{.}
\end{align*}
This allows us to define \emph{Hecke operators} which are correspondences on 
$X_0(N)$. Suppose $p\nmid N$. Then there are canonical maps 
\[\xymatrix{
  X_0(N) 
    & \ar[l]_-\alpha X_0(p N) \ar[r]^-\beta 
    & X_0(N) \text{.}
}\]
If we think $X_0(N)$ and $X_0(p N)$ as modular spaces, these maps are easy to 
define. An element of $X_0(p N)$ is a pair $(E,C)$ where $C$ is cyclic of order 
$p N$; we may decompose $C$ uniquely as $C_p\oplus C_N$, where $C_p$ and $C_N$ 
are cyclic of orders $p$ and $N$. The map $\alpha$ sends $(E,C)$ to 
$(E,C_N)$ and $\beta$ sends $(E,C)$ to $(E/C_N,C/C_N)$. Write 
$T_p$ for the image of $\alpha\times \beta$; this is a subvariety of 
$X_0(N)\times X_0(N)$. In fact, it is a correspondence, so it induces an 
endomorphism of $\h(X_0(N))$ for $\h$ any Weil cohomology theory. In 
particular, we have maps called \emph{Hecke operators} (and also denoted 
$T_p$):
\[
  T_p:S_2(\Gamma_0(N)) = \h^0(X_0(N),\Omega^1) \to \h^0(X_0(N),\Omega^1) = S_2(\Gamma_0(N)) \text{.}
\]
See chapter 12 of \cite{rs11} for a careful discussion. A cusp form 
$f\in S_2(\Gamma_0(N))$ is an \emph{eigenform} if it is an eigenfunction for 
each $T_p$ where $p\nmid N$. 

To see how Theorem \ref{thm:L-cont} follows from Theorem 
\ref{thm:fermat-wiles}, we need to briefly introduce the Mellin transform. Recall 
that for a locally 
compact abelian group $G$, the \emph{Pontryagin dual} $\widehat G$ of $G$ is 
the group $\hom(G,S^1)$ of one-dimensional unitary representations of $G$, with 
the compact-open topology. The group $\widehat G$ is also locally compact. If 
$G=\dR$, then $\widehat G=\dR$ as well, where we interpret $s\in \dR$ as a 
character of $\dR$ via $x\mapsto e^{2\pi i s x}$. For 
$x\in G,y\in \widehat G$, write $\langle x,y\rangle$ instead of $y(x)$. The 
\emph{Fourier transform} of a function $f:G\to \dC$ is the function 
$\widehat f:\widehat G\to \dC$defined by 
\[
  \widehat f(y) = \int_G f(x) \overline{\langle x,y\rangle}\, dx \text{,}
\]
where $d x$ is a Haar measure on $G$. 

The locally compact group $\dR^\times$ (which is isomorphic to $\dR$) has 
dual $i\dR$ via $\langle x,s\rangle = x^{-s}$. A Haar measure on 
$\dR^\times$ is $d^\times x=dx/x$. The \emph{Mellin transform} 
of a function $f:\dR^\times\to \dC$ is just its Fourier transform:
\[
  (\cM f)(s) 
    = \int_{\dR^\times} f(t) \overline{\langle t,s\rangle}\, d^\times t
    = \int_0^\infty f(t) t^{s-1}\, dt
\]
(This is not quite the standard version of the Mellin transform, but it is the 
most natural in our setting.) For a modular form $f$ of level $N$, we can look 
at what is essentially its Mellin transform: 
\[
  \Lambda(f,s) 
    = N^{s/2}\int_0^\infty f(i t) t^{s-1}\, dt  
    = \sum_{n\geqslant 1} a_n \int_0^\infty e^{-2\pi n t} t^{s-1}\,dt \text{.}
\]
Making the substitution $u=2\pi n t$, we get 
\[
  \Lambda(f,s) 
    = N^{s/2} \sum_{n\geqslant 1} \frac{a_n}{(2\pi n)^s} \int_0^\infty e^{-u} u^{s-1}\, du
    = N^{s/2}(2\pi)^{-s} \Gamma(s) \sum_{n\geqslant 1} \frac{a_n}{n^s} \text{.}
    %(= (2\pi)^{-s} \Gamma(s) L(E,s) \text{ if $f$ comes from an elliptic curve})
\]
Note that if $f=f_E$ for an elliptic curve, we have 
$\Lambda(f,s) = \Lambda(E,s)$. By work of Hecke, the function $\Lambda(f,s)$ 
has an analytic continuation to all of $\dC$ and a functional equation 
$\Lambda(f,s) = \pm \Lambda(f,2-s)$. See \cite[VII.9.8]{kn92} for a modern 
proof.  


The function $\sum a_n n^{-s}$ (coming from a modular form $f$) has an analytic 
continuation and a functional equation by a theorem of Hecke. It follows from 
Theorem \ref{thm:fermat-wiles} that if $E$ is an elliptic curve over $\dQ$, 
the function $L(E,s)$ has an analytic continuation to $\dC$ and the prescribed 
functional equation. 

The modularity theorem has a sort of converse. 

\begin{theorem}[Eichler-Shimura]
Let $f=\sum a_n(f) q^n$ be a newform $2$ and level $N$ with 
$a_1=1$ and $a_n\in \dQ$ for all $n$. Suppose further that 
$T_n f = f$ for all $n$ relatively prime to $N$. Then there exists an 
elliptic curve $E_f$ over $\dQ$ such that $a_n(E_f) = a_n(f)$ for all $n$. 
\end{theorem}
\begin{proof}
See \cite[XI.11]{kn92} for a proof and a definition of newforms. The elliptic 
curve $E_f$ can be constructed explicitly in two ways. First, the Riemann 
surface $X_0(N)$ actually has a canonical model (also denoted $X_0(N)$ over 
$\dQ$; we denote its jacobian by $J_0(N)$. There is a subring $\dT_N$ of 
$\End J_0(N)$ called the \emph{Hecke algebra} which contains all of the 
$T_n$. If one puts $I_f = \{T\in \dT_N:T f=0\}$, then 
$E_f=J_0(N)/I_f$. Complex-analytically, $E$ is the quotient of $\dC$ by 
the lattice 
\[
  \left\{ \int_i^{\gamma\cdot i} f(z)\, dz : \gamma\in \Gamma_0(N)\right\} \text{.}
\]
\end{proof}





\subsection{Small analytic rank}

Back to BSD. Let $E$ be an elliptic curve over $\dQ$ with rank $r$, and 
analytic rank 
\[
  r_\text{an} = \ord_{s=1} L(E,s)
\]
By the previous discussion, $L(E,s)$ has an analytic continuation to $s=1$, so 
this is well-defined. As stated earlier, a weak version of BSD is that 
$r=r_\text{an}$. 
From the functional equation, we get $(-1)^{r_\text{an}}=\omega$. The 
\emph{parity conjecture} is that $r\equiv r_\text{an}\pmod 2$. The better 
variant is that $(-1)^r=\omega$. Since $\omega$ can be computed without 
dealing with $L(E,s)$, the parity can be approached computationally. The parity 
conjecture is a theorem whenever $\sha(E)$ is finite. See 
\cite{do10} for discussion and a proof. 

\begin{theorem}\label{thm:r_an=0}
Let $E$ be an elliptic curve over $\dQ$ with 
$r_\textnormal{an}\leqslant 1$. Then $r=r_\textnormal{an}$ and $\sha(E)$ is 
finite. 
\end{theorem}
\begin{proof}
Kolyvagin \cite{ko88} proved the theorem if $r_\text{an}=0$ and $E$ is modular 
(which is known over $\dQ$). If $r_\text{an}=1$, this is follows from work of 
Gross and Zagier \cite{gz86}. 
\end{proof}

One can compute $L(E,s)$ to arbitrary precision. In particular, we can look at 
$L(E,1)$. It turns out that 
\[
  L(E,1) = (1+\varepsilon) \sum_{n\geqslant 1} \frac{a_n}{n} e^{-2\pi n/\sqrt N}
\]
If $\varepsilon=-1$, then $L(E,1)=0$, and it turns out that 
\[
  L'(E,1) = 2 \sum_{n\geqslant 1} \frac{a_n}{n} E_1\left(\frac{2\pi n}{\sqrt N}\right)
\]
where 
\[
  E_1(x) = \int_x^\infty e^{-t}\, \frac{dt}{t} \text{.}
\]

\begin{example}
Let $E$ be the elliptic curve $y^2=x^3+875 x$ over $\dQ$. We can compute 
$L(E,1) = -3.9\ldots$. In particular, $L(E,1)\ne 0$, which implies 
$r_\text{an}=0$. The above theorem tells us that $r=0$, so 
$E(\dQ)=E(\dQ)_\text{tors}=\{O,(0,0)\}$. 
\end{example}

\begin{example}
Let $E$ be the elliptic curve $y^2=x^3+877 x$ over $\dQ$. It turns out that 
$L(E,1) = 0.000\ldots$. This does \emph{not} imply $L(E,1) = 0$. We can 
compute $\omega=-1$, which means $r_\text{an}$ is odd. Thus we cannot have 
$L(E,1) = 0$. The BSD conjecture would imply $E$ has rank at least one. One 
can compute $L'(E,1) = 32.7\dots\ne 0$. In particular, 
$r_\text{an}\leqslant 1$, so the above theorem tells us $r=1$. In other words, 
$E(\dQ)\simeq \dZ/2\oplus \dZ$, hence $E(\dQ)$ is infinite. 
\end{example}










\subsection{The strong Birch and Swinnerton-Dyer conjecture}

The standard version of BSD predicts the order of vanishing of the 
$L$-function $L(E,s)$ of an elliptic curve at $1$ in terms of the algebraic 
rank of $E$. There is a stronger version of the conjecture that also predicts 
the leading term in the Laurent expansion of $L(E,s)$ at $1$. 

\begin{conjecture}[strong BSD]
Let $E$ be an elliptic curve over $\dQ$. Then 
$\rank(E)=r_\textnormal{an}(E)$, $\sha(E)$ is finite, and 
\[
  \lim_{s\to 1} \frac{L(E,s)}{(s-1)^r} = \frac{\Omega_E \regulator_E \# \sha(E) \prod_p c_p}{\# E(\dQ)_\textnormal{tors}^2} \text{.}
\]
\end{conjecture}

We need to explain the quantities appearing in the conjecture. 
% TODO: 
%  - Bloch-Kato, its link with BSD and the analytic class number formula
%  - Grothendieck-Ogg-Saito formula
%  - cohomological definition of L-function of elliptic curve
%  - reduction of abelian varieties, relate to reduction of elliptic curves
%  - L-functions of motives (Tate number-theoretic background is useful here)
First we define the \emph{real period} $\Omega_E$ of $E$. Choose a minimal 
Weierstrass model 
\[
  y^2+a_1 xy+a_3 y=x^3+a_2 x^2+a_4 x+a_6
\]
for $E$, with the $a_i\in \dZ$ and $\Delta=-16(4 ^3+28 b^2)$ minimal with 
respect to divisibility. It is not obvious that this is possible. In fact, it 
can only be done for elliptic curves over global fields with class number one 
\cite[VIII.8.3]{si06}. The differential 
\[
  \omega = \frac{dx}{2 y + a_1 x + a_3}
\]
is called the \emph{invariant differential} associated to $E$. It is unique 
up to a unit in $\dZ$ \cite[VII.1.3]{si06}. We define 
\[
  \Omega_E = \int_{E(\dR)} |\omega|\text{,}
\]
where we choose the orientation of $E(\dR)$ necessary to make the integral 
positive. The real period of $E$ is easily computable using a trick that 
takes advantage of the fast convergence of the algebro-geometric mean. 

Next we define the \emph{regulator} $\regulator_E$ of $E$. Our minimal model 
for $E$ induces an embedding $E\hookrightarrow \dP^2$, and we write $h$ for 
the induced Weil height (see Section \ref{sec:heights} for a general 
definition). We can write any $x\in E(\dQ)$ as $(x_0,x_1,x_2)$ with the 
$x_i\in \dZ$ and $\gcd(x_0,x_1,x_2)=1$. Explicitly, 
\[
  h(x) = \log \max\{|x_0|,|x_1|,|x_2|\} \text{.}
\]
Recall that the N\'eron-Tate height $\widehat h$ associated with our embedding 
can be computed as 
\[
  \widehat h(x) = \lim_{n\to \infty} \frac{h(2^n\cdot x)}{4^n} \text{.}
\]
Using this we define a pairing on $E(\dQ)$:
\[
  \langle x,y\rangle = \frac 1 2\left(\widehat h(x+y)-\widehat h(x)-\widehat h(y)\right) \text{.}
\]
This induces a nondegenerate bilinear pairing (hence the structure of a 
Hilbert space) on $V=E(\dQ)\otimes \dR$. There is a canonical Haar measure 
on any Hilbert space. It is the unique Haar measure such that, given an 
orthonormal basis $\{v_1,\dots,v_r\}$ of $V$, assigns to the fundamental 
domain 
\[
  \left\{\sum_{i=1}^r  \lambda_i v_i : 0\leqslant \lambda_i \leqslant 1\right\}
\]
the volume $1$. For a lattice (discrete, cocompact subgroup) 
$\Lambda\subset V$, put $\volume(\Lambda)=\volume(V/\Lambda)$. Then 
\[
  \regulator_E = \volume(E(\dQ)/E(\dQ)_\text{tors})^2 \text{,}
\]
where $E(\dQ)/E(\dQ)_\text{tors}$ is a thought of as a lattice in 
$E(\dQ)\otimes \dR$. More explicitly, for any basis 
$\{x_1,\dots,x_r\}$ of $E(\dQ)$, one has 
\[
  \regulator_E = \left|\det\left(\langle x_i,x_j\rangle_{i,j}\right) \right| \text{.}
\]

The \emph{Tate-Shafarevich group} of $E$ is 
\[
  \sha(E) = \ker\left(\h^1(\dQ,E) \to \prod_v \h^1(\dQ_v,E)\right)
\]
where as usual we write $\h^1(k,A)$ for $\h^1(G_k,A(\bar k))$ when $k$ is a 
field and $A$ is a commutative group variety over $k$. 

The $c_p$ are \emph{Tamagawa numbers} of $E$. Let $E_0(\dQ_p)$ be the group of 
points in $E(\dQ_p)$ whose reduction modulo $p$ is is nonsingular. We define 
\[
  c_p=[E(\dQ_p):E_0(\dQ_p)]
\]
Clearly $c_p=1$ if $E$ has good reduction at $p$. The $c_p$ are easy to compute 
using Tate's algorithm. 










\subsection{Computations related to BSD}

% y^2+x y = x^3 + x^2 - 1154 x - 15345
%\begin{sagesilent}
%E  = EllipticCurve([1,1,0,-1154,-15345]) 
%L  = E.lseries().dokchitser()
%Om = E.period_lattice().omega()
%\end{sagesilent}

\begin{example}
Let $E$ be the rational elliptic curve $y^2+x y=x^3+x^2-1154 x-15345$. Using 
Sage, we can predict the order of $\sha(E)$. 

\begin{sageblock}
sage: E  = EllipticCurve([1,1,0,-1154,-15345])
sage: Lval  = E.lseries().dokchitser()(1)
sage: Om = E.period_lattice().omega()
sage: factor(E.discriminant())
sage: c3 = E.local_data(3).tamagawa_number()
sage: c227 = E.local_data(3).tamagawa_number()
sage: G = E.torsion_subgroup()
\end{sageblock}

Since $L(E,1)\ne 0$, the analytic rank $r_\text{an}=0$, 
so by Theorem \ref{thm:r_an=0}, $E(\dQ)$ and $\sha(E)$ are finite. Thus 
(as is true for any curve of rank zero) the regulator of $E$ is $1$. 
We now know everything in the BSD formula except for $\# \sha(E)$. Solving for 
it, we get (conjecturally) 
\[
  \# \sha(E) = \frac{L(E,1) \cdot \# E(\dQ)_\text{tors}^2}{\Omega_E \cdot \regulator_E \cdot \prod c_p} = \sage{Lval * G.order()^2 / (Om * c3 * c227)} \text{.}
\]
%\begin{align*}
%  c_3     &= \sage{E.local_data(3).tamagawa_number()} \\
%  c_{227} &= \sage{E.local_data(227).tamagawa_number()}
%\end{align*}

%can compute $L(E,1) = 1.844815\dots\ne 0$. Since $r_\text{an}=0$, $E$ has rank 
%zero by an earlier theorem, so $E(\dQ)$ is finite (and by work of Kolyvagin, 
%$\sha(E)$ is finite). In this case (as with all 
%curves of rank zero) the regulator is $1$. We also have 
%$\Omega_E=2\cdot 0.4099589\dots$ For $p\notin\{3,227\}$ $E$ has good reduction 
%at $p$, so $c_p=1$. Using Tate's algorithm, we get 
%\begin{align*}
%  c_3&= 2 \\
%  c_{227} &= 2 
%\end{align*}
%Finally, $E(\dQ)_\text{tors}\simeq (\dZ/2)^{\oplus 2}$. We know everything in 
%the BSD formula except for $\# \sha(E)$. Solving for it, we get (conjecturally) 
%\[
%  \frac{\Omega_E \cdot \regulator_E\cdot \prod c_p\cdot \sha(E)}{\# E(\dQ)_\text{tors}^2} = 0.2049\dots \cdot \# \sha(E) = L(E,1) = 1.84\ldots
%\]
%This implies (again, assuming BSD) 
%\[
%  \# \sha(E) = 8.999\ldots
%\]
so we could expect $\sha(E)=9$. 
\end{example}

\begin{example}
Let $E$ be the rational elliptic curve $-139\cdot y^2=x^3+4 x^2 - 48 x+80$. 
We can compute $L(E,1) = 0.00\dots$, which may or may not be zero. Moreover, 
$L'(E,0)=0.00\dots$, $L''(E,0) = 0.00\ldots$, but 
$L'''(E,1) = 110.57\dots\ne 0$. In particular, we would guess that 
$r_\text{an}=3$. But we know that $(-1)^{r_\text{an}}=\omega=-1$, so 
$r_\text{an}$ is odd (in particular, $L(E,1)=0$ on the nose). One can do a 
``$2$-descent'' to show that $E(\dQ)\simeq \dZ^{\oplus 3}$. 

\textbf{(use sage to find a basis)}

You can find a basis and compute 
\begin{align*}
  \regulator_E &= 15.36\dots \\
  \Omega_E &= 0.074\ldots \\
  \# E(\dQ)_\text{tors} &= 1 \\
  c_{139} &= 4 \\
  c_p &= 1 \qquad \text{if $p\ne 139$}
\end{align*}
It is not known if $\sha(E)$ is finite, but assuming BSD, its order is 
\[
  \# \sha(E) = \frac{L^{(3)}(E,1)/3!}{\Omega_E \regulator_E \prod c_p / E(\dQ)_\text{tors}^2} = 3.99\dots
\]
so we would expect $\sha(E)=4$. 

Recall that if $r_\text{an}=1$, then work of Gross-Zagier and Kolyvagin implies 
$r=1$. Since $r>1$, we have $r_\text{an}>1$, and since it is odd it must be 
$3$. 
\end{example}

(\textbf{$\#\sha(E)$ would be finite because $\sha(E)[n]$ has a pairing -- 
Cassels did this. Also, parity conjecture holds over $\dQ$ by functional 
equation / modularity?})

Goldfeld used this curve and the fact $r_\text{an}=3$ to show that the class 
number of $\dQ(\sqrt{-D})$ for $D>0$ square-free satisfies the bound 
\[
  h\left(\dQ(\sqrt{-D})\right) > c_\varepsilon \left(\log|D|\right)^{1-\varepsilon}
\]
for an effective constant $c_\varepsilon>0$. Previous lower bounds (by Siegel) 
were ineffective. He used this to classify quadratic imaginary fields with 
class number $1$. \textbf{(write list, cite original paper)}


% averages

Let, for $a,b\in \dZ$, $E_{a,b}:y^2=x^3+a x+b$. Define 
\[
  \cE = \{E_{a,b} : a,b\in \dZ, 4 a^3+27 b^2\ne 0\text{ and there is no $p$ such that $p^4\mid a$ and $p^6\mid b$}\}
\] 
Set $H(E_{a,b}) = \max\{|4 a^3|, 27 b^2\}$; this is not the Faltings height. 
Define 
\[
  \cE_{<x} = \{E\in \cE : H(E)\leqslant x\} \text{.}
\]
Given a map $\phi:\cE\to \dR$, we set 
\[
  \operatorname{avg}(\phi) = \lim_{x\to \infty} \frac{ \sum_{E\in \cE_x} \phi(E)}{\# \cE_x} \text{,}
\]
and let $\overline{\operatorname{avg}}(\phi)$ and 
$\underline{\operatorname{avg}}(\phi)$ be the corresponding lim sups and lim 
infs. 

\begin{theorem}[Bhargava-Shankar, 2010]
$\operatorname{avg}(\# \selmer_2) = 3$ and 
$\overline{\operatorname{avg}}(\# \selmer_3) \leqslant 4$. 
\end{theorem}

As a corollary, $\overline{\operatorname{avg}}(\rank) \leqslant \frac 7 6$. 
David expects the average to be $\frac 1 2$. 

Indeed, since $E(\dQ)/ 3E(\dQ)\hookrightarrow \selmer_3 (E)$, we have 
$e^{\rank E}\leqslant \#\selmer_3(E)=3^s$. It follows that 
$r\leqslant s\leqslant \frac{3^s+3}{6}$, so 
\[
  \overline{avg}(r) \leqslant \frac{\overline{avg}(3^s) }{6} + \overline{avg}(3/6) \leqslant 4/6+1/2=7/6
\]


\documentclass{article}

\usepackage[pazo]{7390-style}

\title{Arithmetic of curves}
\author{Daniel Miller
  \thanks{based on a course taught by David Zywina at Cornell}}
\date{fall 2013}

\begin{document}
\maketitle
\tableofcontents





\newpage
\section*{Disclaimer}
\addcontentsline{toc}{section}{Disclaimer}

These notes originated in a course on the arithmetic of curves taught by David 
Zywina at Cornell. However, a significant amount of material (including, no 
doubt, many errors) has been added since then, so they are far from an exact 
reflection of what he covered in class. Moreover, the notation has been changed 
in many places (sometimes significantly) as has the order in which material is 
covered. Most significantly, the tone of these notes differs drastically 
from the perspective Zywina took in class, with the notes being much more 
cohomological and scheme-theoretic than Zywina's generally elementary (and 
pedagogically correct) approach. Any errors in these notes are entirely my 
fault. 

The original computations for the class were done using the commercial 
computer algebra system Magma. For these notes, everything has been reworked 
into Sage, an open-source alternative designed for for number theorists. Nearly 
all of the Sage code used is contained (using the \LaTeX{} package 
\texttt{sagetex}) in the source code for this document, which may be found at 
\url{https://github.com/dkmiller/7390}. 


\paragraph{Todo}
Clarify definition of local factors in the $L$-function of an abelian variety. 
This should involve a clarification of the relationship between the ``geometric 
Frobenius'' on a variety over a finite field, and the ``arithmetic Frobenius'' 
as an element of an absolute Galois group. 





\section*{Notation and conventions}
\addcontentsline{toc}{section}{Notation and conventions}

We write $\dN$, $\dZ$, $\dQ$, \ldots for the natural numbers, integers, \ldots. 

A \emph{nice variety} over a field $k$ is a smooth, projective, geometrically 
integral variety over $k$. 

If $k$ is a field, $k^s$ (resp. $\bar k$) denote its separable (resp. 
algebraic)closure. We will write $G_k = \gal(k^s/k)$ for the \emph{absolute 
Galois group} of $k$. 

%Unless stated otherwise, all maps will be taken to be morphisms in the 
%appropriate category. 

Let $X$ be a scheme over a finite field $\dF_q$. The \emph{Frobenius of $X$} 
is the morphism $\Phi_X:X\to X$ that is the identity on the underlying 
topological space, and $x\mapsto x^q$ on the structure sheaf. The Frobenius in 
$G_{\dF_q} = \gal(\overline{\dF_q}/\dF_q)$ is the \emph{arithmetic} Frobenius, 
induced by $x\mapsto x^q$ on $\overline{\dF_q}$. We will write $\frob_q$ for 
the arithmetic Frobenius. 

If $v$ is a finite place of a global field $k$, then $k_v$ denotes the 
completion of $k$ with respect to $v$. Most of our notation here is standard, 
with the exception of $\kappa_v=\fo_v/\fp_v$ for the residue field of $v$. 

If $k$ is a global field and $v$ is a finite place, $\frob_v$ denotes the 
arithmetic Frobenius associated to $v$. We will sometimes take $\frob_v$ to be 
a single (non-canonical) element of $G_k$, or the elements' entire conjugacy 
class. This should not cause any confusion. 

The symbol $\h^\bullet{}$ is used to denote cohomology. Unless decorated by a 
descriptive subscript, it should be taken to mean \'etale cohomology. 

If $E$ is a module over a ring $A$ and $x\in E$, then we will write $E/x$ 
instead of $E/(A\cdot x)$. In particular, for $a\in A$, $A/a$ is the quotient 
of $A$ by the ideal generated by $A$. 

All abelian groups are tacitly taken to modules over $\dZ$, so the previous 
convention applies. Even if an abelian group $G$ is written multiplicatively, 
$G/n$ will be used to denote $G/(G^n)$. We write $\torsion n G$ for the 
group $\{g\in G:n\cdot G=0\}$. 










\section*{Motivation: plane curves}
\addcontentsline{toc}{section}{Motivation: plane curves}





Fir a non-constant polynomial $f(x,y)\in\dQ[x,y]$. Assume $f$ is 
geometrically irreducible, that is, irreducible in the ring 
$\overline{\dQ}[x,y]$. We can define the curve $C$ over $\dQ$ determined by the 
equation $f(x,y)=0$. For now, we will think of $C$ in terms of its functor of 
points. To any $\dQ$-algebra $A$, we set $C(A)=\{(a,b)\in A^2:f(a,b)=0\}$. 
As a scheme, $C=\spec\left(\dQ[x,y]/f\right)$. Some big questions are:
\begin{enumerate}
  \item Is $C(\dQ)=\varnothing$?
  \item Is $C(\dQ)$ finite?
  \item Can we compute $C(\dQ)$?
\end{enumerate}
None of these questions can be answered in full generality. 

\begin{example}
Let $f=x^2+y^2-1$, i.e. $C$ is the circle. It is well-known that 
\[
  C(\dQ)=\left\{\left(\frac{1-t^2}{1+t^2},\frac{2t}{1+t^2}\right):t\in\dQ\right\}\cup \{(-1,0)\}
\]
This can be proved in the usual manner by choosing the point $(-1,0)$ in $C$, 
and then drawing lines with rational slopes through $(-1,0)$. As a Riemann 
surface, $C(\dC)$ is a sphere with two points removed. 
\end{example}

\begin{example}
Let $f=x^2+y^2+1$. Then $C(\dR)=\varnothing$, hence $C(\dQ)=\varnothing$. But 
as a Riemann surface, $C(\dC)$ is the same sphere with two points removed. Thus 
the geometry of $C$ does not necessarily determine $C(\dQ)$. 
\end{example}

\begin{example}
Let $f=x^4+y^4-1$. Then it is a theorem of Fermat that 
$C(\dQ)=\{(\pm 1,0),(0,\pm 1)\}$. It is a (much harder) theorem of Wiles that if 
$C_n$ is the curve given by $f=x^n+y^n-1$ for $n\geqslant 3$, then 
$C_n(\dQ)=\{(\pm 1,0),(0,\pm 1)\}$. In fact, this is the celebrated 
``Fermat's last theorem,'' proved in \cite{wi95}. 
\end{example}

\begin{example}[Stoll]
Consider 
\begin{align*}
  C : y^2 = 82342800 x^6 &- 470135160 x^5 + 52485681 x^4 + 2396040466 x^3 \\
    &+ 567207969 x^2 - 985905640 x + 247747600 \text{.}
\end{align*}
This is a curve of genus 2, i.e. $C(\dC)$ is a punctured two-holed 
torus. It turns out that $\# C(\dQ)\geqslant 642$ \cite[\S 6]{st09}. 
However, by a theorem of Faltings, $\# C(\dQ)$ is finite. This example exhibits 
the largest known number of rational points of a genus two curve 
over $\dQ$. If we take $C:y^2=f(x)$ with $f\in\dQ[x]$ a 
``random'' sextic polynomial, then the expectation is that 
$C(\dQ)=\varnothing$. 
\end{example}

It is natural to ask whether for each $g\geqslant 2$ there exists a number 
$B_g$ such that whenever a curve $C$ over $\dQ$ has genus $g$, we have 
$\# C(\dQ)\leqslant B_g$. This is not even known for $g=2$. 

\begin{example}
Let $C:y^2=x^3+875 x$. Note that $C(\dQ)$ has the obvious point 
$(0,0)$, and one can do a bit of work to show that this is the only point. 
\end{example}

\begin{example}
Let $C:y^2=x^3+877 x$. Then $C(\dQ)$ once again contains $(0,0)$. A 
computer search showed that $(0,0)$ is the only point on $C$ of height 
$\leqslant 1000000$. For now, the \emph{height} of a solution is just the 
largest absolute value of the numerator / denominator of a solution written 
in reduced fractions. But other methods lead us to expect many more solutions
(infinitely many, in fact). Let $E$ be the projective curve over $\dQ$ obtained 
by adjoining a point $O$ to $C$. As a Riemann surface, $E(\dC)$ is just a 
torus. 

We can give $E$ the 
structure of an \emph{abelian variety} over $\dQ$. That is, we can give $E$ the 
structure of a commutative algebraic group (the multiplication operation 
$m:E\times E\to E$ is given by regular functions), 
with $O$ being the identity. Later, we will think of $E$ as 
being identified with its jacobian $\jac(E)$ via the choice of a single point 
$O\in E(\dQ)$. Since $E$ is a commutative algebraic group, $E(\dQ)$ is an 
abelian group (with identity $O$). It is a theorem of Mordell that $E(\dQ)$ is 
finitely generated. We know the structure of such groups: 
$E(\dQ)\simeq A\times \dZ^r$, where $A$ is finite, and $r=\rank E$ 
is the \emph{(algebraic) rank} of $E$. 

In general, the group $A$ is (conjecturally) computable. 
In our case, $A=\dZ/2$. It is much harder to 
compute the algebraic rank of $E$. The Birch and Swinnerton-Dyer 
conjecture says that $r$ agrees with the order of vanishing $r'$ of a certain 
holomorphic function $L(E,s)$ at $s=1$. Sometimes, $r'$ can be computed.  
In our example, a computation shows that $r'=1$, so we should expect 
$E(\dQ)\simeq \dZ/2\times\dZ$. In particular, 
$E(\dQ)$ should be infinite. One can show (using other methods) that 
$E(\dQ)=\langle (0,0),(x_0,y_0)\rangle$, where 
\[
  x_0 = \frac{37 5494 5281 2716 2193 1055 0406 9942 0927 9234 6201}{6215 9877 7687 1505 4254 6322 0780 6972 3804 4100}
\]
For details, see \cite{br84}. One method to construct such large solutions for 
a rank one elliptic curve uses Heegner points. 
\end{example}

In general, we will take a curve $C$ over $\dQ$, consider its jacobian $J$, and study 
$J(\dQ)$. This will be a group, and its structure heavily influences $C(\dQ)$. 
For example, we could study how the rank of $J(\dQ)$ affects $C(\dQ)$. In the 
case that $C=E$ is an elliptic curve, $\jac(E)=E$, so studying the curve and 
studying its jacobian is the same thing. The ``average rank of an elliptic 
curve'' is not known, nor is there a general consensus on what is should be. 
Some expect the rank of a random curve to be $0$ or $1$, both with 
probability $\frac 1 2$. Others suppose that elliptic curves over $\dQ$ have 
rank $2$ with nonzero probability as well. It was proven recently (see 
\cite[\S 1]{bh10}) that 
\[
  \limsup_{B\to\infty} \frac{1}{4 B^2} \sum_{\substack{|a|,|b|\leqslant B \\ 4 a^3+27 b^2\ne 0}} \rank(E_{a,b}) \leqslant\frac 7 6 \text{,}
\]
where $E_{a,b}$ is the elliptic curve over $\dQ$ defined by $y^2=x^3 +a x+b$.

It is natural to ask whether there is a global bound for $\rank E(\dQ)$ as 
$E$ ranges over all elliptic curves over $\dQ$. 
It is known that there are curves with rank at least $28$, but their exact 
ranks are not known \cite{du}. The largest known rank is $19$.  

Our assumption that $f(x,y)$ is irreducible is not a serious one. For example, 
if $f=y^2-x^2$, then we can factor $f$ as $(x+y)(x-y)$, and then treat the 
solutions to $x+y=0$ and $x-y=0$ separately. Another example is $f=x^2+y^2$, 
which only factors over $\dQ(i)$ as $(y+i x)(y-i x)$, and we the rational 
points lie in the intersection of the two components over $\dQ(i)$. In general, 
a curve over $\dQ$ will be the union of finitely many geometrically irreducible 
components, each of which is defined over some finite extension of $\dQ$. Also, 
the assumption that $f\in \dQ[x,y]$ is not serious, as every curve is 
birational to a plane curve. 

Let $C$ be a curve over $\dQ$. Then 
$C(\dC)\smallsetminus \{\text{singular points}\}$ is a compact Riemann 
surface with points removed, i.e. it is a torus with $g$ handles with finitely 
many points removed. Call this $g$ the \emph{genus} of $C$. 

\begin{theorem}[Faltings, conjectured by Mordell]
If $C$ is a curve over $\dQ$ with $g\geqslant 2$, then $C(\dQ)$ 
is finite. 
\end{theorem}

For curves of genus $g<2$, $\# C(\dQ)$ can be infinite. In Faltings' 
theorem, $\dQ$ can be replaced by any field finitely generated over 
$\dQ$. 

Now let $C$ be a smooth projective curve of genus $g$ over $\dF_p$. 
We are interested in $\#C(\dF_{p^n})$, which is obviously computable 
for each $n$. Define the \emph{zeta function} of $C$ to be the formal power 
series 
\[
  Z(C,t) = \exp\left( \sum_{n\geqslant 1} \# C(\dF_{p^n}) \frac{t^n}{n} \right) \text{.}
\]

\begin{theorem}[Weil]\label{thm:Weil-curve}
If $C$ is a smooth projective curve of genus $g$ over $\dF_p$, then 
\[
  Z(C,t) = \frac{P(C,t)}{(1-t)(1-p t)} \text{,}
\]
where $P(C,t)\in \dZ[t]$ has degree $2 g$. Moreover, if we write
$P(C,t) = \prod_{i=1}^{2 g} (1-\alpha_i t)$, then for each $i$, we have 
$|\alpha_i|=p^{1/2}$. 
\end{theorem}

The second statement in the theorem is called the \emph{Riemann hypothesis} 
for $C$. It can be used to obtain explicit bounds on the size of 
$C(\dF_{p^n})$ as $n\to\infty$. For example, we can compute 
\begin{align*}
  \sum_{n>0} \# C(\dF_{p^n}) \frac{t^n}{n} 
    &= \log Z(C,t) \\
    &= -\log(1-t) - \log(1-p t) + \sum_i \log(1-\alpha_t t) \\
    &= \sum_{n>0} \left(p^n+1-\sum_{i=1}^{2 g} \alpha_i^n\right) \frac{t^n}{n} \text{.}
\end{align*}
Therefore, $\# C(\dF_{p^n}) = p^n+1-\sum_{i=1}^{2 g} \alpha_i^n$. It 
follows easily that $|\# C(\dF_{p^n})-(p^n+1)| \leqslant 2 g p^{n/2}$. 
This is equivalent to saying 
\[
  p^n-2 g p^{n/2}+1 
    \leqslant \# C(\dF_{p^n}) 
    \leqslant p^n + 2 g p^{n/2} + 1 \text{.}
\]
In particular, setting $n = g = 1$, we obtain 
$\# C(\dF_p) \geqslant (p^{1/2}-1)^2>0$, hence 
$C(\dF_p)\ne\varnothing$. 










\input{7390-1_jacobians}
\input{7390-2_mordell-weil}
\input{7390-3_finite-fields}
\input{7390-4_L-functions}
\input{7390-5_Faltings}










\appendix
\section{Brief introduction to \'etale cohomology}

Our definition of \'etale morphisms follows \cite[17.1]{ega4}. For more 
detailed introductions on \'etale cohomology, see \cite{mi-ec} and \cite{de77}. 





\begin{definition}
A morphism $f:X\to Y$ of schemes is \emph{formally \'etale} if whenever 
$V$ is an affine scheme over $Y$ and $V_0\subset V$ is defined by a nilpotent 
ideal, then for every $v_0:V_0 \to X$ over $Y$, there exists a unique 
$v:V\to X$ making the following diagram commute. 
\[\xymatrix{
  V_0 \ar[r] \ar[d]_-{v_0} 
    & V \ar[d] \ar@{.>}[dl]_-v \\
  X \ar[r]^-f 
    & Y
}\]
We say $f:X\to Y$ is \emph{\'etale} if it is formally \'etale and locally of 
finite presentation. 
\end{definition}

For a scheme $X$, let $\et X$ be the category of \'etale morphisms 
$U\to X$. Every morphism in $\et X$ is \'etale. We say that a collection 
$\{U_i\to V\}$ of morphisms in $\et X$ is an \emph{\'etale cover} if each 
$V_i \to X$ is \'etale, and moreover the map $\coprod U_i \to V$ is surjective. 
With this notion of coverage, the category $\et X$ is a site, the so-called 
\emph{small \'etale site} of $X$. Let $\sheaf(\et X)$ denote the category of 
sheaves of abelian groups on $\et X$. The global sections functor 
$\Gamma:\sheaf(\et X) \to \mathsf{Ab},\sF\mapsto \sF(X)$ is left-exact, so we 
can put as usual 
\[
  \h_\text{\'et}^i(X,-) = \h^i(\et X,-) = \mathsf R^i \Gamma :\sheaf(\et X) \to \mathsf{Ab}
\]
for the $i$-th right derived functor of $\Gamma$. 

If $X$ is a variety over a non-algebraically closed field and $\sF$ is an 
\'etale sheaf on $X$, then one often considers 
$\h_\text{\'et}^i(X_{k^s},\sF)$ instead of $\h_\text{\'et}^i(X,\sF)$. The 
former has a continuous action of $G_k=\gal(k^s/k)$. Alternatively, we can 
let $f:X\to \spec(k)$ be the structure morphism and consider the higher 
pushforward sheaves $\mathsf R^i f_\ast \sF$ on 
$\et{\spec(k)}\simeq G_k\text{-}\mathsf{Mod}$. By \cite[I 4.1.1]{de77}, these 
are naturally isomorphic if $X$ is proper. 

Suppose $X$ is a scheme on which $n$ is invertible. Let $\sheaf(\et X,\dZ/n)$ 
be the category of sheaves of $\dZ/n$-modules on $\et X$. Since the \'etale 
topology is subcanonical, the group $\mu_n$ of $n$-th roots of unity is in 
$\sheaf(\et X,\dZ/n)$. Put $\dZ/n(i) = \mu_n^{\otimes i}$, and for any $\sF$ in 
$sheaf(\et X,\dZ/n)$, define $\sF(i) = \sF\otimes_{\dZ/n}\dZ/n(i)$. This gives 
functors $(i):\sheaf(\et X,\dZ/n) \to \sheaf(\et X,\dZ/n)$. If $f:X\to Y$ is a 
morphism, then $(i)\circ f_\ast=f_\ast\circ (i)$ as functors 
$\sheaf(\et X,\dZ/n) \to \sheaf(\et Y,\dZ/n)$. Since $(i)$ is exact, we compute  
\[
  \mathsf R f_\ast \circ (i) = \mathsf R f_\ast \circ \mathsf R (i) \simeq \mathsf R(f_\ast \circ(i)) = \mathsf R((i)\circ f_\ast)\simeq  \mathsf R(i)\circ \mathsf R f_\ast = (i)\circ \mathsf R f_\ast \text{,}
\]
as functors $\mathsf D(\et X,\dZ/n) \to \mathsf D(\et Y,\dZ/n)$. It follows 
that for $X$ proper over a field $k$ in which $n$ is invertible, we have 
$\h^\bullet(X_{k^s},\sF(i)) \simeq \h^\bullet(X_{k^s},\sF)(i)$ for all $i$. 

For simplicity, suppose $X$ is proper over an algebraically closed field $k$ in 
which a prime $\ell$ is invertible. Let $\dZ/\ell^n$ denote the constant sheaf 
associated to the group $\dZ/\ell^n$. The functoriality of \'etale cohomology 
yields maps 
\[
  \h^i(\et X,\dZ/\ell) \leftarrow \h^i(\et X,\dZ/\ell^2) \leftarrow \cdots 
\]
and we put $\h^i(\et X,\dZ_\ell) = \varprojlim \h^i(\et X,\dZ/\ell^n)$ and 
$\h^i(\et X,\dQ_\ell) = \h^i(\et X,\dZ_\ell)\otimes \dZ$. This definition fits 
into the general framework of \emph{$\ell$-adic sheaves} set up in \cite{de80}. 

For $X$ a variety over a finite field $\dF_q$, the assignment  
$X\mapsto \h_\text{\'et}^\bullet(X_{\overline{\dF_q}},\dZ_\ell)$ constitutes a 
\emph{Weil cohomology theory} in the sense of \cite[3.3]{an04}. 










\bibliographystyle{alpha}
\bibliography{7390-sources}

\end{document}


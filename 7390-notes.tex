\documentclass{article}

\usepackage{7390-style}

\title{Arithmetic of curves}
\author{Daniel Miller\thanks{notes to a course taught by David Zywina at Cornell}}
\date{fall 2013}

\begin{document}
\maketitle

% perhaps include illustrations (graphs) of curves?










\section*{Disclaimer}

These notes originated in a course on the arithmetic of curves taught by David 
Zywina at Cornell. However, their content is \emph{not} an exact reflection of 
what he covered in class, and some material was not presented in class. In 
particular, any errors in these notes are entirely my fault. 










\section{Plane curves}

Fir a non-constant polynomial $f(x,y)\in\dQ[x,y]$. Assume $f$ is 
geometrically irreducible (i.e. irreducible in $\overline{\dQ}[x,y]$). 
We can define the curve $C$ over $\dQ$ determined by the equation 
$f(x,y)=0$. For now, we will think of $C$ in terms of its functor of points. 
To any $\dQ$-algebra $A$, we have $C(A)=\{(a,b)\in A^2:f(a,b)=0\}$. 
For those of you who know about schemes, 
$C=\spec\left(\dQ[x,y]/f\right)$. Some big questions are:
\begin{enumerate}
  \item Is $C(\dQ)=\varnothing$?
  \item Is $C(\dQ)$ finite?
  \item Can we compute $C(\dQ)$?
\end{enumerate}
None of these questions are known in full generality. 

\begin{example}
Let $f=x^2+y^2-1$, i.e. $C$ is the circle. It is well-known that 
\[
  C(\dQ)=\left\{\left(\frac{1-t^2}{1+t^2},\frac{2t}{1+t^2}\right):t\in\dQ\right\}\cup \{(-1,0)\}
\]
This can be proved in the usual manner by choosing the point 
$(-1,0)$ in $C$, and then drawing lines with rational slopes through 
$(-1,0)$. As a Riemann surface, $C(\dC)$ is a sphere minus 
two points. 
\end{example}

\begin{example}
Let $f=x^2+y^2+1$. Then $C(\dR)=\varnothing$, hence 
$C(\dQ)=\varnothing$. But as a Riemann surface, $C(\dC)$ is 
the same sphere minus two points. Thus the geometry of $C$ does not 
necessarily determine $C(\dQ)$. 
\end{example}

\begin{example}
Let $f=x^4+y^4-1$. Then it is a theorem of Fermat that 
$C(\dQ)=\{(\pm 1,0),(0,\pm 1)\}$.
\end{example}

\begin{example}[Stoll]
Consider 
\begin{align*}
  C : y^2 = 82342800 x^6 &- 470135160 x^5 + 52485681 x^4 + 2396040466 x^3 \\
    &+ 567207969 x^2 - 985905640 x + 247747600
\end{align*}
This is a curve of genus 2, i.e. $C(\dC)$ is a punctured two-hole 
torus. It turns out that $\# C(\dQ)\geqslant 642$ \cite[\S 6]{st09}. 
However, by a theorem of Faltings, $\# C(\dQ)$ is finite. It is 
currently the largest known number of rational points of a genus two curve 
over $\dQ$. If we take $C:y^2=f(x)$ with $f\in\dQ[x]$ a 
``random'' sextic polynomial, then the expectation is that 
$C(\dQ)=\varnothing$. 
\end{example}

\begin{question}
Does there exist a number $B_g$ such that if a curve $C/\dQ$ has 
genus $g\geqslant 2$, then $\# C(\dQ)\leqslant B_g$?
\end{question}

This is not even known for genus $g=2$. 

\begin{example}
Let $C:y^2=x^3+875 x$. Note that $C(\dQ)$ has the obvious point 
$(0,0)$, and one can do a bit of work to show that this is the only point. 
\end{example}

\begin{example}
Let $C:y^2=x^3+877 x$. Then $C(\dQ)$ once again contains $(0,0)$. A 
computer search showed that $(0,0)$ is the only point on $C$ of height 
$\leqslant 1000000$. For now, the \emph{height} of a solution is just the 
largest absolute value of the numerator / denominator of a solution written 
in reduced fractions. But there should be more solutions! Let $E$ be the 
projective curve over $\dQ$ obtained by adjoining a point $O$ to $C$. 
As a Riemann surface, $E(\dC)$ is just a torus. 

We can give $E/\dQ$ the structure of an abelian variety. That is, 
we can give $E$ the structure of a commutative algebraic group, i.e. the 
operation is given by rational functions, with $O$ being the identity. 

Later, we will think of $E\hookrightarrow \operatorname{Jac}(E)$, where 
$\operatorname{Jac}(E)$ is the Jacobian of $E$. This embedding is determined 
by a single point $O\in E$. 

In particular, $E(\dQ)$ is an abelian group with identity $O$. It is 
a theorem of Mordell that $E(\dQ)$ is in fact finitely generated. We 
know the structure of such groups: $E(\dQ)\simeq A\times \dZ^r$, 
where $A$ is finite, and $r=\operatorname{rk} E$ is the \emph{rank} of $E$. 

In general, $A$ is computable. In our case, $A=\dZ/2$. The hard 
computational problem is: ``what is $r$''? The Birch and Swinnerton-Dyer 
conjecture says that $r$ agrees with the order of vanishing $r'$ of a certain 
holomorphic function $L(E,s)$ at $s=1$. Sometimes, $r'$ can be computed.  
In our example, a computation shows that $r'=1$, so we expect 
$E(\dQ)\simeq \dZ/2\times\dZ$. In particular, 
$E(\dQ)$ should be infinite. One can show (using other methods) that 
$E(\dQ)=\langle (0,0),(x_0,y_0)\rangle$, where 
\[
  x_0 = \frac{37 5494 5281 2716 2193 1055 0406 9942 0927 9234 6201}{6215 9877 7687 1505 4254 6322 0780 6972 3804 4100}
\]
For details, see \cite{br84}. One method to construct such large solutions for 
a rank one elliptic curve uses Heegner points. 
\end{example}

In general, we will take a curve $C/\dQ$, consider its jacobian $J$, 
and study $J(\dQ)$. This will be a group, and its structure heavily 
influences $C(\dQ)$. The ``average rank of an elliptic curve'' is not 
known, nor is there a general consensus on what is should be. Some expect it 
the rank of a random curve to be $0$ or $1$, both with probability 
$\frac 1 2$. Others suppose that elliptic curves over $\dQ$ have rank 
$2$ with nonzero probability as well. It was proven recently (see 
\cite[\S 1]{bh10}) that 
\[
  \limsup_{B\to\infty} \frac{1}{4 B^2} \sum_{\substack{|a|,|b|\leqslant B \\ 4 a^3+27 b^2\ne 0}} \operatorname{rk}(E_{a,b}) \leqslant\frac 7 6
\]
where $E_{a,b}$ is the elliptic curve defined by $y^2=x^3 +a x+b$.

\begin{question}
Is $\operatorname{rk} E(\dQ)$ bounded for all elliptic curves 
$E/\dQ$?
\end{question}

It is known that there are curves with rank at least $28$, but their exact 
ranks are not known \cite{du}. The largest known rank is $19$. 
%It is generally thought that the answer is no, and that the NSA has examples of curves with 
%much larger ranks than publicly known. 

In general, the assumption that $f(x,y)$ is absolutely irreducible is not a 
serious one. For example, if $f=y^2-x^2$, then we can factor $f$ as 
$(x+y)(x-y)$, and then treat the solutions to $x+y=0$ and $x-y=0$ separately. 
Another example is $f=x^2+y^2$, which only factors over $\dQ(i)$ as 
$(y+i x)(y-i x)$, and we the rational points lie in the intersection of the 
two components over $\dQ(i)$. Also, the assumption that 
$f\in \dQ[x,y]$ is not serious. One can prove that every curve 
$C/\dQ$ embeds into $\mathbb{P}^2_\dQ$, hence is birational to 
a plane curve. 

Let $C/\dQ$ be a curve. Then 
$C(\dC)\setminus \{\text{singular points}\}$ is a compact Riemann 
surface with points removed, i.e. it is a torus with $g$ handles with finitely 
many points removed. Call this $g$ the \emph{genus} of $C$. 

\begin{theorem}[Faltings, conjectured by Mordell]
If $C$ is a curve over $\dQ$ with $g\geqslant 2$, then $C(\dQ)$ 
is finite. 
\end{theorem}

For curves of genus $g<2$, $\# C(\dQ)$ can be infinite. In Faltings' 
theorem, $\dQ$ can be replace by any field finitely generated over 
$\dQ$. 

Now let $C$ be a smooth projective curve of genus $g$ over $\mathbb{F}_p$. 
We are interested in $|C(\mathbb{F}_{p^n})|$, which is obviously computable 
for each $n$. Let 
\[
  Z(C,t) = \exp\left( \sum_{n>0} \# C(\mathbb{F}_{p^n}) \frac{t^n}{n} \right) \in \dQ\llbracket t\rrbracket 
\]

\begin{theorem}[Weil]
If $C/\mathbb{F}_p$ is a smooth projective curve of genus $g$, then 
\[
  Z(C,t) = \frac{P(C,t)}{(1-t)(1-p t)}
\]
where $P(C,t)\in \dZ[t]$ has degree $2 g$. Moreover, if 
$P(C,t) = \prod_{i=1}^{2 g} (1-\alpha_i t)$, then for each $i$, one has 
$|\alpha_i|=p^{1/2}$. 
\end{theorem}

The second statement in the theorem is called the \emph{Riemann hypothesis} 
for $C$. It can be used to obtain explicit bounds on the size of 
$C(\mathbb{F}_{p^n})$ as $n\to\infty$. For example, we can compute 
\begin{align*}
  \sum_{n>0} \# C(\mathbb{F}_{p^n}) \frac{t^n}{n} 
    &= \log Z(C,t) \\
    &= -\log(1-t) - \log(1-p t) + \sum_i \log(1-\alpha_t t) \\
    &= \sum_{n>0} \left(p^n+1-\sum_{i=1}^{2 g} \alpha_i^n\right) \frac{t^n}{n} \text{.}
\end{align*}
Therefore, $\# C(\mathbb{F}_{p^n}) = p^n+1-\sum_{i=1}^{2 g} \alpha_i^n$. It 
follows easily that $|\# C(\mathbb{F}_{p^n})-(p^n+1)| \leqslant 2 g p^{n/2}$. 
This is equivalent to saying 
\[
  p^n-2 g p^{n/2}+1 \leqslant \# C(\mathbb{F}_{p^n}) \leqslant p^n + 2 g p^{n/2} + 1
\]
In particular, setting $n = g = 1$, we obtain 
$\# C(\mathbb{F}_p) \geqslant (p^{1/2}-1)^2>0$, hence 
$C(\mathbb{F}_p)\ne\varnothing$. 










% notes taken on 09-03-2013

\section{Some analysis: jacobians over \texorpdfstring{$\dC$}{C}}

In this section, we will mostly work over $\dC$ and treat curves as 
Riemann surfaces. First, some more general definitions:

\begin{definition}
A \emph{variety} over a field $k$ is a separated scheme of finite type over 
$\spec(k)$. We call a variety $X/k$ \emph{nice} if it is smooth, projective, 
and geometrically integral.
\end{definition}

Recall that $X/k$ is \emph{geometrically integral} if 
$X_{\bar k}=X\times_k \spec(\bar k)$ is dimension $1$. A \emph{curve} is a 
variety of dimension one. If we are interested in $C(k)$ for general curves, 
it is sufficient to consider nice curves. If $X$ is a variety, we can consider 
its functor of points $h_X:\mathsf{Alg}_k\to \mathsf{Set}$ which assigns to a 
$k$-algebra $A$ the set $X(A)$ of ``$A$-valued points.'' This determines a 
functor $h_X:\mathsf{Sch}_k^\circ\to\mathsf{Set}$ which is defined by 
$h_X(Y)=\hom_k(Y,X)$. 

Earlier, for $f\in \dQ[x,y]$ and $C$ defined by the equation $f=0$, we 
defined $C(A)=\{(a,b)\in A^2:f(a,b)=0\}$ for any $\dQ$-algebra $A$. 
Note that 
\begin{align*}
  C(A) &= \{(a,b)\in A^2:f(a,b) = 0\} \\
    &= \hom_{\mathsf{Alg}_\dQ}(\dQ[x,y]/f,A) \\
    &= \hom_{\mathsf{Sch}_k}\left(\spec A,\spec(\dQ[x,y]/f)\right) \\
\end{align*}
so this agrees with our general definition. 

\begin{remark}
The functor $h_X$ determines $X$, up to isomorphism. (This is just the Yoneda 
lemma).
\end{remark}

For the rest of this section, let $C$ be a nice curve over $\dC$. Set 
$X=C(\dC)$; this is a compact connected Riemann surface. So 
topologically, $X$ is a many-handled torus. Let $\Lambda=\h_1(X,\dZ)$, 
the first singular homology group of $X$, which can be identified with 
$\pi_1(X)^\text{ab}$. So elements of $\Lambda$ are equivalence classes 
$[\gamma]$ for $\gamma\in \pi_1(X)$. 

\begin{remark}
The notation $\h_\bullet$, $\pi_1$\ldots will always denote the 
\emph{topological} homology, fundamental group\ldots. For, e.g. 
etale cohomology, we will write $\h_\text{et}^\bullet(C,\dQ_\ell)$, or 
$\h_\text{crys}^\bullet(X/\dZ_p)$ for crystalline cohomology.
\end{remark}

It is a theorem of algebraic topology that $\Lambda\simeq\dZ^{2 g}$; we 
will call $g$ the \emph{genus} of $X$ (and also of $C$). Let $K$ be the field 
of meromorphic functions on $X$. In other words, elements of $K$ are of the 
form $f=g/h$ where $g$ and $h$ are holomorphic functions on $X$ and $g\ne 0$. 
(This forces $g\ne 0$ except on a finite subset of $X$.) At any point 
$x\in X$, we can write $f$ in local coordinates as $z^n(a_0+a_1 z+\cdots)$ 
where $a_0\ne 0$ and $n\in\dZ$. We call $n=\ord_x(f)$ the \emph{order 
of vanishing} of $f$ at $x$. 
 
\begin{remark}
We can identify $K$ with the function field of $C$, i.e. the set of rational 
maps $C\to\mathbb{A}^1$. Certainly rational maps yield meromorphic functions, 
and it is a basic theorem of Riemann surface theory that meromorphic functions 
are in fact algebraic. Moreover, if $C$ is nice, then $C$ can be recovered 
from $K$. To do this, pick some $x\in K\setminus \dC$. If we let $A$ be 
the integral closure of $\dC[x]$ in $K$, then $\spec(A)$ will be a 
smooth affine curve. Pick some embedding of $\spec(A)$ into projective space; 
the closure of its image will be a projective curve $C'$ (possibly with 
singularities) with function field $K$. We can resolve the singularities of 
$C'$ to obtain a smooth projective curve $C''$ with function field $K$. 
Clearly $C''$ and $C$ are birational -- in fact this forces them to be 
isomorphic. Indeed, let $f:C''\to C$ be a birational map. By 
\cite[thm 3.1]{mi}, $f$ and $f^{-1}$ are in fact regular, hence $f$ is an 
isomorphism of varieties. 
\end{remark}

One might ask whether the singular homology $\h_1(X,\dZ)$ can be 
defined ``algebraically.'' Essentially, the answer is no -- that is, there is 
no known algebraic definition for $\h_1(X,\dZ)$ that gives the 
``right'' answers. On the other hand, $\h_1(X,\dQ)$ is naturally 
isomorphic to the dual of the algebraic de Rham cohomology 
$\h_\text{dR}^1(X/\dQ)$, and $\h_1(X,\dZ_\ell)$ is naturally 
isomorphic to the dual of the $\ell$-adic cohomology 
$\h_\text{et}^1(X,\dZ_\ell)$. Both of these isomorphisms are hard 
theorems -- the first follows from work of Grothendieck \cite{gr66}, the 
second from \cite[I 4.6.3]{de77}. 

With $C$ as before, let $V=\Omega^1(X)=\h^0(X,\Omega^1)=\h^1_\text{dR}(X)$. 
This is a complex vector space of dimension $g$. (Here, we mean analytic de 
Rham cohomology -- the algebraic de Rham cohomology would be denoted 
$\h_\text{dR}^1(C/\dC)$.) This gives us an algebraic definition of $g$. 
We can consider $\Omega^1$ as the sheaf of (algebraic) differentials, and 
$g=\dim_\dC\h^0(X,\Omega^1)$. There is a pairing 
$\h_1(X,\dZ)\otimes\h_\text{dR}^1(X)\to\dC$, defined by 
\[
  [\gamma]\otimes \omega \mapsto \int_\gamma \omega
\]
This pairing is $\dC$-linear in the second component, and is in fact 
non-degenerate. It gives us a map $\Phi:\Lambda\to V^*$. 

\begin{definition}[analytic]
The \emph{Jacobian} of $X$ is 
$\jac X=V^*/\Phi(X) = \h_\textnormal{dR}^1(X)^*/\h_1(X,\dZ)$. 
\end{definition}

Is is known that $\Phi(\Lambda)$ is a lattice in $V^*$, i.e. it is discrete 
and $V^*/\Phi(\Lambda)$ is compact. There is the \emph{Abel-Jacobi map} from 
$X$ to $\jac X$ defined as follows. Fix $x_0\in X$; we send $x\in X$ to 
$\omega\mapsto \int_{[x_0,x]} \omega$, where $[x_0,x]$ denotes some path from 
$x_0$ to $x$. A different choice of $[x_0,x]$ will differ by a closed loop, 
i.e. an element of $\h_1(X,\dZ)$. So $X\to\jac X$ is well-defined. Note 
that $\jac X$ is a complex Lie group. 

\begin{remark}
After choosing a basis for $V^*$, we have $\jac X\simeq \dC^g/L$, where 
$L\simeq \dZ^{2 g}$. As a real Lie group, $\jac X$ is diffeomorphic to 
$(S^1)^{2 g}$. 
\end{remark}

We care about $\jac X$ because, despite its analytic definition, it is in fact 
a projective variety.

\begin{theorem}
For $X$ a compact Riemann surface, $\jac X$ is algebraic, i.e. there exists a 
variety $J$ defined over $\dC$ such that $J(\dC)\simeq\jac X$ as 
complex manifolds. Moreover, the group operation on $\jac X$ is algebraic, 
i.e. there is a morphism $m:J\times_\dC J\to J$ such that 
$J(\dC)\times J(\dC)\to J(\dC)$ corresponds to the 
addition law on $\jac X$. 
\end{theorem}
\begin{proof}
look up in \cite{mu08}
\end{proof}

Let $\Div X$ be the free abelian group generated by the points of $X$. There 
is a map $\deg:\Div X\to \dZ$, defined by 
$\sum n_x\cdot x\mapsto \sum n_x$. We define $\Div^\circ X$ by the short exact 
sequence 
\[
  0 \to \Div^\circ X \to \Div X \to \dZ \to 0
\]
There is also a map $\operatorname{div}:K^\times\to \Div X$, where 
$\operatorname{div}(f) = \sum_x \ord_x(f)\cdot x$. It is a basic fact that 
$\deg(\operatorname{div}(f)) = 0$, so we can define the \emph{Picard group} 
of $X$ to be $\pic X = \Div X/\operatorname{div}(K^\times)$ and 
$\pic^\circ X = \Div^\circ (X)/\operatorname{div}(K^\times)$. 

\begin{remark}
Let $\mathscr{M}$ be the sheaf of meromorphic functions on $X$. One can 
prove that $\Div(X)=\h^0(X,\mathscr{M}^\times/\sO^\times)$ and 
$\pic(X)=\h^1(X,\sO^\times)$. 
\end{remark}

\begin{example}
One can prove that $\pic^\circ(\mathbb{P}^1) = 0$.
\end{example}

The Abel-Jacobi map $\mu:X\to \jac X$ extends to a map 
$\mu:\Div^\circ X\to \jac X$. 

\begin{theorem}[Jacobi]
The map $\mu:\Div^\circ X\to\jac X$ is surjective.
\end{theorem}

\begin{theorem}[Abel]
The kernel of $\mu:\Div^\circ X\to \jac X$ is $\operatorname{div}(K^\times)$. 
\end{theorem}

It follows that $\mu$ induces an isomorphism $\mu:\pic^\circ X\to \jac X$. 
Note that $\pic^\circ X$ parameterizes invertible sheaves (line bundles) on 
$X$ of degree zero. 

Note that in general, $\dC^g/L$ for some lattice $L$ need not be 
algebraic if $g>1$. In the future, we'll try to define $\jac C$ for a curve 
$C$ over an any field. The variety $\jac C$ will be a nice variety, i.e. 
smooth, projective and geometrically integral. We will use this to give an 
algebraic definition of $\h_1(X,\dZ/n)$. 





% lecture on 09-05-2013
\section{Jacobians in algebraic geometry}

Recall that a variety $X/k$ is \emph{nice} if it is smooth, projective, and 
geometrically connected. 

\begin{definition}
Let $k$ be a field. An \emph{abelian variety} over $k$ is a nice group variety 
over $k$.
\end{definition}

In other words, there are morphisms $m:A\times A\to A$, $i:A\to A$, 
$e:\spec(k)\to A$ such that the induced maps $m_*:h_A\times h_A\to h_A$ etc. 
turn $h_A$ into a group-valued functor. In particular, $A(X)$ is a ``actual 
group'' for each $k$-scheme $X$. 

\begin{example}
The group variety $\operatorname{GL}_n$ is a group variety, but not nice (in 
the technical sense) because it is not projective.
\end{example}

Note that abelian varieties are not required to be commutative, but this is in 
fact the case. This is easy to see over $\dC$. If $A/\dC$ is an 
abelian variety, then $G=A(\dC)$ is a compact connected complex Lie 
group. Let $\mathfrak{g}$ be its Lie algebra. Consider the composite map 
$f:G\xrightarrow{\text{ad}}\operatorname{GL}(\mathfrak{g}) \hookrightarrow 
\operatorname{End}(\mathfrak{g})$, where 
$\operatorname{ad}:G\to\operatorname{GL}(\mathfrak{g})$ is the adjoint 
representation. After picking a basis for $\operatorname{End}(\mathfrak{g})$, 
the components of $f$ are entire holomorphic functions on a compact complex 
manifold, hence locally constant. Since $G$ is connected, $f$ is constant, i.e. 
$\operatorname{ad}$ is the trivial representation. But 
$\ker(\operatorname{ad}) = Z(G)$, so $G$ is commutative. For more details, see 
\cite[I.1]{mu08}. The case $A/k$ for arbitrary $k$ of characteristic zero 
follows from the Lefschetz principle, or one can just prove commutativity 
directly using a ``rigidity principle'' for maps on projective varieties
\cite[I.1.4]{mi}. 

We'd like to describe the jacobian $J$ of a nice curve $C/k$ with 
$C(k)\ne\varnothing$. It will be an abelian variety over $k$ of dimension 
$g$, the genus of $C$. (Note we've only defined the genus for curves 
$C/k$ with $k\subset\dC$. For general curves, we set  
$g(C)=h^0(C_{\bar k},\Omega^1) = h^1(\sO_C)$, where 
$h^i(X,\sF)$ for some sheaf $\sF$ denotes 
$\dim_k\h^i(X,\sF)$. 

\begin{definition}[Albanese]
Let $C/k$ be a curve with fixed $x_0\in C(k)$. The \emph{jacobian} of $C$ is 
an abelian variety $J$ with a morphism $\mu:C\to J$ taking $x_0$ to $0$, such 
that for any morphism $f:C\to A$ to an abelian variety $A$ with $f(x_0)=0$, 
thre is a unique $\tilde f:J\to A$ making the following diagram commute:
\[\xymatrix{
  C \ar[r]^-\mu \ar[dr]_-f 
    & J \ar@{.>}[d]^-{\tilde f} \\
  & A
}\]
\end{definition}

Standard abstract nonsense shows that the pair $(J,\mu)$ is unique up to 
unique isomorphism. There is a more concise way of defining $J=J_C$. The 
assignment $C\mapsto J_C$ is the left-adjoint to the functor 
$\mathsf{AbVar}_k\to \mathsf{Var}_{k,*}$ from abelian varieties over $k$ to 
nice pointed varieties over $k$ that forgets the group structure. In fact, the 
functor $\mathsf{AbVar}_k\to\mathsf{Var}_{k,*}$ has a left-adjoint defined 
on all of $\mathsf{Var}_{k,*}$. For any nice pointed variety $X$, there is an 
abelian variety $A=\operatorname{Alb} X$, the \emph{Albanese variety} of $X$, 
such that pointed maps $X\to B$ correspond to homomorphisms of abelian 
varieties $A\to B$. For a proof that $\operatorname{Alb} X$ exists, see 
\cite[A.11]{mo12}

If $C(k)=\varnothing$, we can still define $J=\jac C$. We consider the 
morphism $\alpha:C\times C\to J$ given by $(x,y)\mapsto \mu(x)-\mu(y)$, 
and require maps $f:C\times C\to A$ with $f(\Delta)=0$ to lift uniquely 
to $\tilde f:J\to A$. 

Another approach to defining $J=\jac C$ involves the Picard group. Recall 
that over $\dC$, we proved that $J(\dC)\simeq\pic^\circ(C)$. 
One might hope that $J$ satisfies $J(L)=\pic^\circ(C_L)$ for all field 
extensions $L/k$. This works if $C(k)\ne\varnothing$, but otherwise. For, 
if $J(k^s)=\pic^\circ(C_{k^s})$, then we would have 
$\pic^\circ(C) = J(k) = J(k^s)^{G_k} = \pic^\circ(C_{k^s})^{G_k}$. But this 
does not always hold. 

First, it might be helpful to define Picard groups for general schemes. If 
$X$ is a scheme, the \emph{Picard group} of $X$ is 
$\pic(X)=\h^1(X,\sO_X^\times)$. It is straightforward to show that 
$\pic(X)$ is isomorphic to the group of isomorphism classes of invertible 
sheaves on $X$, with group operation induced by tensor product, i.e. 
$[\sL] + [\mathscr{L'}] = [\sL\otimes \sL']$. 

If $D = \sum D_x\cdot x$ is a divisor on a curve $C/k$, we define the 
\emph{degree} of $D$ to be $\deg D=\sum D_x \in \dZ$. 
%We would like to 
%have a definition that works on arbitrary varieties. First, we replace $D$ by 
%the invertible sheaf $\sL=\sO(D)$, where $\sL(U)$ is the ring 
%of rational functions $f$ on $U$ such that $\ord_x(f)\geqslant - D_x$. One 
%can check that $\sO(D)$ is indeed an invertible sheaf. We will define the 
%degree of any invertible sheaf $\sL$ on a projective variety $X/k$. 
%Recall that the Euler characteristic of $\sL$ is 
%$\chi(\sL) = \sum (-1)^i h^i(\sL)$. It is proven in 
%\cite[4.1]{dj93} that there exists a (unique) polynomial 
%$\phi\in\dQ[t]$ such that 
%$\chi(\sL^{\otimes n}) = \phi(n)$ for $n\gg 0$. If $X$ is a curve, we 
%can see this easily; since $\sL=\sO(D)$ is effective, the Riemann-Roch 
%forces $\chi(\sL^{\otimes n}) = n\cdot \deg D + 1 - g$ for $n\gg 0$. 
%We define the \emph{degree} of $\sL$ to be the coefficient of the 
%highest-degree term of $\phi$. As we have just shown, this agrees with the 
%classical definition. 

Back to the case where $C$ is a nice curve. For $T$ an arbitrary scheme, define 
$\pic^\circ(C\times T)$ to be the subset of $\pic(C\times T)$ consisting of 
invertible sheaves $\sL$ with $\deg(\sL_t)=0$ for all $t\in T$, 
i.e. the following sequence is exact 
\[\xymatrix{
  0 \ar[r] 
    & \pic^\circ(C\times T) \ar[r]^-{(i_t^*)}
    & \displaystyle\prod_{t\in T} \pic^\circ (C) 
}\]
where $i_t:t\hookrightarrow T$ are the canonical injections. Now we define the 
functor $P_C^\circ:\mathsf{Sch}_k^\circ\to\mathsf{Ab}$ that sends $T$ to 
$\pic^\circ(C\times_k T)/\pi_T^*\pic(T)$. 

\begin{theorem}
If $C(k)\ne \varnothing$, then $P_C^\circ$ is represented by $J=\jac C$.
\end{theorem}

For a proof, see \cite[III.1.2]{mi}. 

\begin{remark}
In general, the map $X\to \operatorname{Alb} X$ need not be an embedding. 
For example, if $C$ is a curve of genus $0$, then $\operatorname{Alb} X=0$ by 
\cite[I.3.9]{mi}. On the other hand, if the genus $g\geqslant 1$, then 
$C\to J$ is an embedding. The map $C(\bar k)\to \pic^\circ(C_{\bar k})$ sends 
a point $x$ to the divisor $[x]-[x_0]$, and one can check that this is 
injective. For, principal divisors correspond to morphisms 
$f:C\to\mathbb{P}^1$. These cannot have zeros and poles of multiplicity one, 
otherwise $f$ would have degree one, hence it would be an isomorphism. This 
cannot be the case. 
\end{remark}

In general, we might have $C(k)=\varnothing$. We will have 
$J(L)=\pic^\circ(C_{L'})^{\gal(L'/L)}$ where $L'/L$ is any separable extension 
with $C(L')\ne\varnothing$. 

The idea behind Weil's original construction is the following. We already 
know that $J=\jac C$ exists, and has a canonical map $\mu:C\to J$. Consider 
$C^g=C\times\cdots\times C$ ($g$-fold product), and consider the map 
$f:C^g\to J$, $f(x_1,\dotsc,x_g)=\mu(x_1)+\cdots+\mu(x_g)$. The symmetric 
group $S_g$ acts on $C^g$, and $f$ is $S_g$-equivariant. The quotient 
$\operatorname{Sym}^g C = C^g/S_g$ exists, and has a map 
$\operatorname{Sym}^g C\to J$. This is birational. Weil defined a ``rational 
group law'' on $\operatorname{Sym}^g C$ using the Riemann-Roch theorem. For 
more details on Weil's construction (and proofs), see \cite[III.7]{mi}. 










% lecture on 09-10-2013
\section{More abelian varieties}

Let $k$ be a field, $C/k$ a nice curve, and $J=\jac_C = J_C = \jac C$ be its 
jacobian. Recall that $J$ is a nice variety that is also a commutative group 
scheme. We had $J(T) = \pic^\circ(C\times T)/\pic(T)$ for all $k$-schemes $T$, 
under the assumption that $C(k)\ne \varnothing$. 

Now suppose $X$ is an arbitrary scheme. Recall that 
$\pic(X)=\h^1(X,\sO_X^\times)$; this classifies invertible sheaves on 
$X$, where the group operation on sheaves is $\otimes$. If $X$ is integral, 
$\pic(X)$ is isomorphic to the class group $\operatorname{Cl}(X)$ of Cartier 
divisors (Weil divisors if $X$ is a nice curve). This is easy to prove. Recall 
that if $\mathscr{M}$ is the sheaf of rational functions on $X$, then the 
group of Cartier divisors is $\Div(X) = \h^0(X,\mathscr{M}^\times/\sO^\times)$. 
The short exact sequence 
\[
  1 \to \sO^\times \to \mathscr{M}^\times\to \mathscr{M}^\times/\sO^\times \to 1
\]
induces a long exact sequence in sheaf cohomology:
\[
  0 \to \h^0(\sO^\times) \to \h^0(\mathscr{M}^\times) \to \Div(X) \to \pic(X) \to \h^1(\mathscr{M}^\times) \to \cdots
\]
When $X$ is integral, $\mathscr{M}^\times$ is flasque, so 
$\h^1(\mathscr{M}) = 0$, whence 
$\pic(X)=\Div(X)/\h^0(\sO^\times) = \operatorname{Cl}(X)$. 

For $X/k$ an arbitrary scheme, consider the functor 
$\pic_X:\mathsf{Sch}_k^\circ\to\mathsf{Ab}$ given by 
$\pic_X(T) = \pic(X\times_k T)/\pic(T)$. This is not in general 
representable. However, if $X$ is a nice $k$-variety, then the 
fppf-sheafification of $\pic_X$ is representable \cite[4.1.38]{kl05}. Even 
better, if $X(k)\ne\varnothing$, then $\pic_X$ is representable 
\cite[2.5]{kl05}. We will also denote the representing scheme by $\pic_X$, and 
we call $\pic_X$ the \emph{Picard scheme} of $X$. It is not a variety, but it 
is a disjoint union of ind-varieties \cite[4.8]{kl05}. More precisely, choose 
a very ample line bundle $\sL$ on $X$. If $\sF$ is any coherent 
sheaf on $X$, write 
$\sF(n) = \sF\otimes\sL^{\otimes n}$. Recall that the 
\emph{Euler characteristic} of $\sF$ is 
$\chi(\sF) = \sum (-1)^i h^i(\sF)$. By \cite[2.5.3]{gr61}, 
there is a (unique) polynomial $\phi\in \dQ[t]$ such that 
$\chi\left(\sF(n)\right) = \phi(n)$ for all 
$n\in\dZ$; set $h_\sL(\sF) = \phi$. We call $\phi$ the 
\emph{Hilbert polynomial} of $\sF$. The Hilbert polynomial 
$h_\sL(\sF)$ does depend on $\sL$.

Denote by 
$\pic_X^\phi$ the functor which assigns to a scheme $T$ the subset of 
$\pic_X(T)$ consisting of invertible sheaves $\sF$ on $X\times T$ with 
$h_\sL(\sF_t) = \phi$ for all $t\in T$. By \cite[6.20]{kl05}, 
$\pic_X^\phi$ represents a clopen subscheme of $\pic_X$, and $\pic_X$ is 
covered by the $\pic_X^\phi$. Moreover, the $\pic_X^\phi$ are varieties. We can 
do even better. If we let $\pic_X^d$ send $T$ to the subset of $\pic_X(T)$ 
consisting of invertible sheaves $\sF$ with 
$\deg h_\sL(\sF_t) = d$ for all $t\in T$, then the 
$\pic_X^d$ form a cover of $\pic_X$ by clopen subvarieties. Just as the genus 
of a curve is the dimension of its jacobian, there is a natural isomorphism 
$\h^1(\mathscr{O}_X) \simeq \operatorname{Lie}(\pic_X)$, from which we deduce 
$\dim(\pic_X) = h^1(\mathscr{O}_X)$ when $X$ is nice \cite[5.11]{kl05}.

Suppose $X=A$ is already an abelian variety over $k$. Then one has 
\[
  \pic_A^\circ(\bar k) = \left\{c\in \pic(A_{\bar k}) : t_a^* c = c\text{ for all }a\in A(\bar k)\right\} 
\]
where $t_a:A_{\bar k}\to A_{\bar k}$ is translation by $a$. See 
\cite[I.8.4]{mi} for a partial proof. 

Unlike the case when $X$ is a curve, it is not always true that 
$\pic_X(\bar k)/\pic^\circ(\bar k) = \dZ$. In general, we set 
$\operatorname{NS}(X) = \pic_X(\bar k) / \pic_X^\circ(\bar k)$, and call 
$\operatorname{NS}(X)$ the \emph{N\'eron-Severi group} of $X$. 

In any case, the \emph{dual} of $A$ is defined to be $A^\vee = \pic_A^\circ$. 
Each $c\in \pic(A)$ gives a map $\varphi_c:A\to A^\vee$. At the level of 
points, it is defined as $a\mapsto t_a^* c - c$, where if $c=[\sL]$, 
the class $t_a^*c - c\in A^\vee(\bar k) = \pic^\circ(A)$ is represented by 
$[t_a^*\sL\otimes\sL^{-1}]$. 

It turns out that $A^{\vee\vee} \simeq A$, so calling $A^\vee$ the dual of $A$ 
is rather natural. The map $\varphi_c:A\to A^\vee$ is a homomorphism of abelian 
varieties. If $c$ is ample (i.e. the map from $A$ to some projective space 
induced by $n\cdot c$ for $n\gg 0$ is an embedding) then $\varphi_c$ is an 
\emph{isogeny}, where 

\begin{definition}
A homomorphism $\varphi:A\to B$ is an \emph{isogeny} if it is surjective with 
finite kernel.
\end{definition}

It is not at all obvious, but ``$A$ is isogenous to $B$'' is an equivalence 
relation on abelian varieties. The relation is clearly reflexive and 
transitive. To see that it is symmetric, suppose we have an 
isogeny $\varphi:A\to B$. For any ample $c\in \pic(A^\vee)$, $d\in \pic(B)$, 
the composite 
\[\xymatrix{
  B \ar[r]^-{\varphi_d} 
    & B^\vee \ar[r]^-{\varphi^\vee} 
    & A^\vee \ar[r]^-{\varphi_c}
    & A^{\vee\vee} \ar[r]^-\sim 
    & A
}\]
is an isogeny. 

\begin{definition}
Let $A$ be an abelian variety. A \emph{polarization} of $A$ is an isogeny 
of the form $\varphi_c:A\to A^\vee$ for some ample $c\in \pic(A)$.
\end{definition}





\section{Jacobians revisited}

Let $k$ be a field, $C/k$ a nice curve, and $J=\jac C$ its jacobian. What does 
(the arithmetic of) $J$ tell us about (the arithmetic of) $C$? In particular, 
can we recover $C$ from $J$? In general, $J$ does not determine $C$. For 
example, if $g=g(C)=0$, then $A=0$, and there are many non-isomorphic nice 
curves of genus zero (over a non-algebraically closed field). There are more 
difficult examples with genus $g>0$. 

Suppose we add some data. Assume $g\geqslant 2$ and $C(k)\ne\varnothing$. This 
gives us a map $\mu:C\to J$ determined by $x\mapsto 0$ for some distinguished 
$x\in C(k)$. Consider $\theta = \mu(C)+\cdots + \mu(C)$, where there are $g-1$ 
terms in the sum. It turns out that $\theta$ is an irreducible ample divisor of 
$J$. Thus $\theta$ induces a polarization $\varphi_\theta:J\to J^\vee$. 

\begin{theorem}[Torelli]
If $C,C'$ are nice curves over a field $k$ with $(J,\theta)\simeq (J',\theta')$, 
then $C\simeq C'$ over $k$. 
\end{theorem}

It is known that $\varphi_\theta:J\to J^\vee$ is actually an isomorphism. We 
call a polarization $A\to A^\vee$ \emph{principal} if it is an isomorphism. 

\begin{question}[Schottky]
What pairs $(A,c)$, with $c$ inducing a principal polarization, come from 
jacobians? 
\end{question}

This question has an easy partial answer if we are willing to use heavy 
machinery. Consider the functor $\mathcal{M}_g$ which sends a scheme $S$ to the 
set of isomorphism classes of curves of genus $g$ over $S$. The functor 
$\mathcal{M}_g$ is unfortunately not representable (there is n 
\emph{fine} moduli spaces for curves), but it is nearly so (there is a 
\emph{coarse} moduli space). That is, there is a scheme (a variety, 
actually) $M_g$ together with a natural transformation 
$\mathcal{M}_g\to h_{M_g}$ such that $\mathcal{M}_g(L)\to h_{M_g}(L)$ is a 
bijection whenever $L$ is an algebraically closed field, and such that 
$\mathcal{M}_g\to h_{M_g}$ is initial among all morphisms from $\mathcal{M}_g$ 
to representable functors. For a proof, see \cite[5]{mu94}. Along the same lines, 
we can let $\mathcal{A}_g$ be the functor which assigns to a scheme $S$ the set 
of isomorphism classes of principally polarized abelian schemes of dimension 
$g$ over $S$. The functor $\mathcal{A}_g$ has a coarse moduli space $A_g$. 

The operation ``take Jacobian'' induces a natural transformation 
$j:\mathcal{M}_g\to\mathcal{A}_g$, and Torelli's theorem can be rephrased as 
saying that $j$ is injective. Shottky's question asks what the image of $j$ is. 
To see that it cannot be all of $\mathcal{A}_g$, simply note that 
$\dim(M_g) = 3 g - 3$, while $\dim(A_g) = \frac{g(g+1)}{2}$. For 
$g>3$, $A_g$ has greater dimension than $M_g$, so 
$j:M_g(\bar\dQ)\to A_g(\bar\dQ)$ cannot possibly be surjective. On the other 
hand, for $g\leqslant 3$, all principally polarized abelian varieties are 
jacobians (possibly after a change of the polarization). 

One might hope that all abelian varieties are at least isogenous to jacobians. 
While this is true for dimension $d\leqslant 3$, it is not true in general. 
In fact, for all $d>3$, there exists an abelian variety of dimension $d$ over 
$\overline{\dQ}$ which is not isogenous to a jacobian. This was proven 
recently in \cite{ts12}

\begin{example}
Let $C/k$ be a nice curve of genus one and $C(k)\ne\varnothing$. Choose 
$O\in C(k)$; this gives us an embedding $C\hookrightarrow J$, which is in fact 
an isomorphism. Thus $C$ obtains a group law with $O$ as the identity. 

Suppose we begin with the equation $y^2=x^3 + a x+b$ where $a,b\in k$, 
$4 a^3+27 b^2\ne 0$ and $\operatorname{char}(k)\nmid 6$. Let 
$C\subset \mathbb{P}_k^2$ be the projective closure of the plane curve defined 
by $y^2-x^3-a x-b$. This is a nice curve of genus $1$. Take distinct points 
$P,Q\in C(L)$ for some field $L/k$. We would like to determine $P+Q$. Take the 
line in $\mathbb{P}_L^2$ through $P$ and $Q$, given by $\alpha x+\beta y = c$ 
for some $\alpha,\beta$. This line and $C$ intersect in three points $P,Q,R$ 
(counting multiplicities). The divisor 
$\operatorname{div}(\alpha x+\beta y - c) = P+Q+R - 3 O$, where $O$ is the 
point at infinity. Rewrite this divisor as $(P-O)+(Q-O)+(R-O)$. In 
$\pic^\circ(C_L)$, $[P-O] + [Q-O] + [R-O] = \mu(P)+\mu(Q)+\mu(R) = 0$. Note 
that in general, three points $P,Q,R$ are colinear if and only if 
$\mu(P)+\mu(Q)+\mu(R) = 0$ in $\pic^\circ(C)$. So, we have shown that 
$-\mu(R) = \mu(P)+\mu(Q)$. If $P=Q$, we need to take the tangent line to $C$ at 
$P$. To compute $-R$, take a vertical line through $R$. This will intersect 
$C$ at $O$ and some $R'$. Thus $\mu(R)+\mu(R')+\mu(O)$, from which we see that 
$\mu(P)+\mu(Q) = \mu(R')$. 
\end{example}










% notes on 09-12-2013
\section{The Mordell-Weil theorem}

Let $k$ be a number field, i.e. $k$ is a finite extension of $\dQ$. Important 
examples are $k=\dQ(\sqrt d)$ and $\dQ(\zeta_{p^n})$. 

\begin{theorem}[Mordell-Weil]
Let $A$ be an abelian variety over a number field $k$. Then the abelian group 
$A(k)$ is finitely generated.
\end{theorem}

Note that is clearly false if $k=\dC$, for then $A(\dC)$ is a complex Lie 
group, hence uncountable. In fact, whenever $k$ is a local field, $A(k)$ is a 
Lie group over $k$, hence uncountable. The Mordell-Weil theorem actually holds 
whenever $k$ is finitely generated over its prime field. Basic algebra shows 
that $A(k) = A(k)_\text{tors}\oplus \dZ x_1\oplus \cdots \oplus \dZ x_r$, where 
the $x_i$ are linearly independent over $\dZ$. We call $r=\operatorname{rk} A$ 
the \emph{rank} of $A$. Mordell proved the theorem for $A=E/\dQ$ an elliptic 
curve, demonstrating an assertion of Poincar\'e.
%Mordell 1922, Poincare 1901

\begin{example}
Let $E\subset \mathbb{P}_\dQ^2$ be the projective closure of the affine curve 
defined by $y=x^3+2 x+3$, with $O=(0:0:1)$ the point at infinity. The curve 
has a group law where $a+b+c=0$ if and only if $a,b,c$ are colinear. 
Alternatively, there is a unique map $E\hookrightarrow J_E$ with $O\mapsto 0$; 
this is an isomorphism, and we can use it to transfer the group structure of 
$J_E$ to $E$. The curve $E$ has an obvious rational point $(-1,0)$ of order 
two. Another rational points is $(3,6)$. Their sum is 
$\left(\frac 1 4,-\frac{15}{16}\right)$. One can show that 
$E(\dQ) = \langle (-1,0)\rangle \oplus \langle (3,6)\rangle$, where 
$(-1,0)$ has order two and $(3,6)$ has infinite order. So 
$E(\dQ) = \dZ/2\oplus \dZ$. 
\end{example}

\begin{example}
Let $E/\dQ$ be the projective closure of $y^2+y = x^3+x^2 - 2 x$. We claim 
that $E(\dQ) = \langle (0,0),(1,0)\rangle$. As an exercise, try to find ten 
more points in $E(\dQ)$. 
\end{example}

One thing that motivated Weil is the following conjecture of Mordell (now a 
theorem of Faltings). 

\begin{theorem}[Faltings]
If $C$ is a nice curve over a number field $K$ with genus $g\geqslant 2$, then 
$C(k)$ is finite.
\end{theorem}

Note that Mordell's conjecture definitely fails if $g\leqslant 1$. For $g=0$, 
$\mathbb{P}^1$ has lots of rational points, and we have seen examples of 
elliptic curves with infinitely many rational points. Here is a heuristic. 
Assume $C(k)\ne\varnothing$ and consider the canonical embedding 
$C\hookrightarrow J$. We have $C(k)=C\cap J(k)$. The set $C$ has positive 
codimension, and $J(k)$ is a finitely generated abelian group. So 
$C(k)$ is the intersection of two ``sparse'' subsets of $J$. One would expect 
this forces $C(k)$ to be small. This heuristic is validated by the following 
theorem, which was conjectured by Mordell and Lang.

\begin{theorem}[Faltings]
Let $A$ be an abelian variety over an algebraically closed field $k$, and let 
$\Gamma$ be a finitely generated subgroup of $A(k)$. If $X\subset A$ is a 
subvariety, then there is a finite set $S\subset \Gamma$ and a finite set 
$\{B_s:s\in S\}$ of abelian subvarieties of $A$ contained in $X$ such that 
\[
  X(k)\cap \Gamma = \bigcup_{s\in S} \left(s+ B_s(k)\cap \Gamma\right)
\]
\end{theorem}
A proof in the case $k=\dC$ can be found in \cite{mc95}, who proves the theorem 
for more general group varieties than abelian varieties. 

\begin{corollary}
Let $A$ be an abelian variety over $\dC$, let $C$ be a nice curve in $A$ of 
genus $g\geqslant 2$. Let $\Gamma$ be a finitely generated subgroup of 
$A(\dC)$. Then $C(\dC)\cap \Gamma$ is finite. 
\end{corollary}
\begin{proof}
Since $C$ has genus $g\geqslant 2$, it cannot contain a nontrivial abelian 
variety. Thus each $B_s = 0$, so the theorem yields $C(\dC)\cap \Gamma = S$ 
for some finite set $S\subset \Gamma$. 
\end{proof}

There is a relative version of the Mordell-Lang conjecture known as the 
\emph{Lang-N\'eron theorem}. Let $K/k$ be a \emph{regular} field extension, 
that is, $\bar k\cap K = k$ and $K/k$ is separable. If $A$ is an abelian 
variety defined over $K$, then there is an abelian variety 
$\operatorname{tr}_{K/k}(A)$ defined over $k$ together which a morphism 
$\tau:\operatorname{tr}_{K/k}(A)_K\to A$ that is initial among abelian 
varieties $B/k$ with morphisms $B_K\to A$. One calls 
$\operatorname{tr}_{K/k}(A)$ the \emph{$K/k$-trace of $A$}. Intuitively, 
$\operatorname{tr}_{K/k}(A)$ is the smallest abelian subvariety of $A$ defined 
over $k$. A proof of the following theorem can be found in \cite{co06}. 

\begin{theorem}[Lang-N\'eron]
Let $K/k$ be a finitely generated regular extension, and let $A$ be an abelian 
variety over $K$. Then the group $A(K)/\operatorname{tr}_{K/k}(A)(k)$ is 
finitely generated.
\end{theorem}

This implies the Mordell-Weil theorem for finitely generated fields. If $K$ is 
a finitely generated field, let $k$ be the algebraic closure of the prime field 
of $K$ within $K$. Then $K/k$ is regular, and by the usual Mordell-Weil 
theorem, $\operatorname{tr}_{K/k}(A)(k)$ is finitely generated, so $A(K)$ has a 
finitely generated subgroup with finitely generated quotient. It follows that 
$A(K)$ is finitely generated.

\begin{proof}[Proof of Mordell-Weil]
Let $A$ be an abelian variety over a number field $k$. Our proof has three 
parts:
\begin{enumerate}
  \item construct a ``height function'' $|\cdot|:A(k)\to \dR_{\geqslant 0}$ 
    with good properties
  \item prove the weak Mordell-Weil theorem: $A(k)/n A(k)$ is finite for all 
    $n\geqslant 2$
  \item show that 1 and 2 formally imply the full Mordell-Weil theorem 
\end{enumerate}
We will prove 3 here, defer 2 to the next section, and cite a source for 1. 
Suppose $A$ is an arbitrary abelian group with a function 
$|\cdot|:A\to \dR_{\geqslant 0}$ satisfying 
\begin{itemize}
  \item for any $c>0$, the set $B_c = \{x\in A:|x|\leqslant c\}$ 
    is finite
  \item we have $|x-y|\leqslant |x|+|y|$ and $|n x|=n |x|$ for all 
    $x\in A$ and some $n\geqslant 2$
  \item for the same $n\geqslant 2$, the group $A/n$ is finite
\end{itemize}
We will prove that $A$ is finitely generated. Let $\{a_i\}$ be a (finite) set 
of coset representatives for $A/n$. Let $c=2\sup \{|a_i|\}$. We claim that $A$ 
is generated by the finite set $B_c$. This will be shown by 
descent. Let $x_1\in A$. By our assumptions, we can write 
$x_1 = y_{i_1} + n x_2$, and one see that 
\[
  |x_2| = \frac 1 n |x_1 - y_{i_1}| 
    \leqslant \frac{|x_1| + |y_{i_1}|}{n} 
    \leqslant \frac 1 n |x_1| + \frac{c}{2 n}
\]
Setting $x_{r+1} = y_{i_r} + n x_r$, we can continue this process, obtaining 
the inequality 
\[
  |x_{r+1}| \leqslant \frac 1 n |x_r| + \frac{c}{2 n}
    \leqslant \frac{1}{n^r} |x_1| + \frac 1 2\left(\frac 1 n + \cdots + \frac{1}{n^r}\right) c 
    \leqslant \frac{|x_1|}{n^r} + \frac c 2
\]
For $r\gg 0$, the quantity on the right is less than $c$. Thus $x_1$ is in the 
subgroup of $A$ generated by $B_c$ and $\{a_i\}$. Since $|a_i|\leqslant c$ for 
each $i$, we have $A=\left\langle B_c\right\rangle$. 
\end{proof}

We will not prove the existence of a height function on $A(k)$ satisfying the 
desired properties. Choose a very ample divisor $c\in \pic(A)$. This yields 
an embedding $\varphi=\varphi_c:A\to \mathbb{P}_k^N$ for some $N$. There is a 
canonical height function on $\mathbb{P}^N(\bar k)$ defined by 
\[
  h(x_0:\dotsm : x_n) = \sum_v \log \sup\{|x_i|_v\}
\]
where $v$ ranges over all places of $k$ and $|\cdot|_v$ is the normalized 
absolute value associated with $v$. For $x\in A(\bar k)$, let 
$h_c(x) = h(\varphi_c(x))$. The function $h_c:A(\bar k)\to \dR_{\geqslant 0}$ 
does not necessarily have good properties, but there is a unique function 
$\widehat h_c:A(\bar k)\to \dR_{\geqslant 0}$, differing from $h_c$ by a 
bounded function, such that 
\[
  (x,y)\mapsto \langle x,y\rangle_{\widehat h_c} = \widehat h_c(x+y) - \widehat h_c(x) - \widehat h_c(y)
\]
is bilinear. One can compute $\widehat h_c$ directly. It is given by 
$\widehat h_c(x) = \lim_{n\to \infty} n^{-2} h_c(n\cdot x)$. If $c$ is even 
(i.e. $i^*c = c$ where $i:A\to A$ is inversion) then 
$\langle \cdot,\cdot\rangle_{\widehat h_c}$ is actually a symmetric bilinear 
form. The function $\widehat h_c$ is called the \emph{N\'eron-Tate height} 
associated with $c$. The Picard group $\pic(A)$ is generated by very ample 
divisors, so we can extend our definition to a map 
$\widehat h:\pic(A)\to \dR^{A(\bar k)}$ given by 
$\widehat h_{c-d} = \widehat h_c - \widehat h_d$, where $c,d$ are very 
ample divisors. It turns out that $\widehat h$ is a well-defined 
homomorphism. If we let 
$\operatorname{R}(A) = \mathbb{R}^{A(\bar k)}$, then the N\'eron-Tate height 
is a natural transformation $\widehat h : \pic\to \operatorname{R}$, 
i.e. $\widehat h_{f^* c} = \widehat h_c\circ f$ for any morphism of abelian 
varieties $f:A\to B$. The function $|\cdot|$ used in the proof of is just 
$\widehat h_c^{1/2}$ for some very ample even divisor $c$. For more details, 
and a proof that $\widehat h_c$ has the desired properties, see \cite[9.2]{bg06}.









Our proof is very nearly effective. Given a set of generators for 
$A(k)/n A(k)$, it gives an algorithm for finding a set of generators for 
$A(k)$. Moreover, one can choose any $n$. Most people use $n = 2$ when doing 
computations. In the next section, we will give a proof of the weak 
Mordell-Weil theorem using Galois cohomology. Let $\bar k$ be the algebraic 
closure of $k$, and let  $G_k = \gal(\bar k/k)$ be the absolute Galois group of 
$k$. The abelian group $A(\bar k)$ has a continuous $G_k$-action. One way to 
see this is to embed $A$ into some $\mathbb{P}^N$, and let $G_k$ act on 
coordinates. A fancier way to see this is to note that 
$A(\bar k) = \hom(\spec(\bar k),A)$, so if $\sigma\in G_k$, $x\in A(\bar k)$, 
the point $^\sigma x$ is the composite 
$\spec(\bar k)\xrightarrow{\sigma^*} \spec(\bar k) \xrightarrow{x} A$. 

Let $A[n]$ be the kernel of $\cdot n : A(\bar k)\to A(\bar k)$. We can take 
$G_k$-invariants of $A[n]$. We get an exact sequence 
\[\xymatrix{
  0 \ar[r] 
    & A[n]^{G_k} \ar[r] 
    & A(k) \ar[r]^-n 
    & A(k)
}\]
We are interested in continuing this exact sequence to the right, i.e. in 
constructing a long exact sequence 
\[
  0 \to A[n]^{G_k} \to A(k) \to A(k) \to \h^1(G_k,A[n]) \to \h^1\left(G_k,A(\bar k)\right)\to \h^1\left(G_k, A(\bar k)\right) \to \h^2\left(G_k, A[n]\right) \to \cdots
\]
This fits into a general framework of derived functors, but we will mostly 
just use the concrete definition of $\h^\bullet(G_k,-)$ using cocycles and 
coboundaries. 










% lecture 09-17-2013
\section{Group cohomology}

Eventually we'll get to Selmer groups and the weak Mordell-Weil theorem, but 
first we need to discuss group cohomology. Let $k$ be a number field, $\bar k$ 
an algebraic closure of $k$, and $G_k=\gal(\bar k/k)$ the \emph{absolute Galois 
group} of $k$. This is a \emph{profinite group} (compact, totally connected 
Hausdorff group) with a basis of neighborhoods of $1$ being the groups 
$G_L=\gal(\bar k/L)$ where $L$ ranges over the finite extensions of $k$. Let 
$A$ be an abelian variety over $k$ of dimension $d\geqslant 1$. There is no 
harm in thinking of $k=\dQ$ and $A$ as an elliptic curve. 

The homomorphism $A\xrightarrow n A$ that sends $x$ to $n\cdot x$ is an 
isogeny. Let $A[n]$ be the $n$-torsion subgroup of $A(\bar k)$, i.e. 
\[
  A[n] = \{x\in A(\bar k) : n\cdot x = 0\}
\]
If $k$ were a field of positive characteristic $p$ and $p\mid n$, it would be 
better to think of $A[n]$ as the scheme $A\times_A 0$ via $n:A\to A$. In any 
case, there is an exact sequence 
\[\xymatrix{
  0 \ar[r] 
    & A[n] \ar[r] 
    & A(\bar k) \ar[r]^-n 
    & A(\bar k) \ar[r] 
    & 0
}\]
Recall that if $G$ is an arbitrary group acting on some abelian group $M$, we 
define $M^G=\{m\in M:\sigma m = m\forall \sigma\in G\}$, the module of 
\emph{$G$-invariants} of $M$. Taking $G_k$-invariants of the above short exact 
sequence, we get an exact sequence 
\[\xymatrix{
  0 \ar[r] 
    & A[n]^{G_k} \ar[r] 
    & A(k) \ar[r]^-n 
    & A(k)
}\]
We don't have exactness on the right because $(-)^{G_k}$ is only left exact in 
general. More concretely, if $A(k)\xrightarrow n A(k)$ were always surjective, 
then $A(k)$ would be a divisible abelian group, which contradicts the fact that 
if $k$ is a number field, then $A(k)$ is finitely generated. 

We can define $\h^\bullet(G_k,A[n])$ using derived functors. Consider the 
category $G_k\text{-}\mathsf{Mod}$ of (discrete) abelian groups with continuous 
$G_k$-action. This is an abelian category with enough injectives. The functor 
$\Gamma=(-)^{G_k}:G_k\text{-}\mathsf{Mod}\to \mathsf{Ab}$ is left-exact, we we 
define the group cohomology as the derived functors of $\Gamma$, i.e. 
$\h^\bullet(G_k,-) = \mathsf{R}^\bullet \Gamma$. In particular, 
$\h^0(G_k,M) = M^{G_k}$ for any discrete $G_k$-module $M$. 

Choose $x\in A(k)$. Then $x=n\cdot y$ for some $y\in A(\bar k)$. Take 
$\sigma\in G_k$. Then $x=\sigma x$, so $\sigma(n\cdot y) = n\cdot \sigma(y)$. 
Then $n\cdot (\sigma y - y) = n\cdot \sigma y - n\cdot y = 0$, so 
$\sigma y-y\in A[n]$. Thus we have a map (\emph{not} a usually a homomorphism) 
$\varphi:G_k\to A[n]$, $\sigma\mapsto \sigma y - y$. Take $\sigma,\tau\in G_k$. 
Then one computes 
\begin{align*}
  \varphi(\sigma\tau) &= \sigma\tau(y) - y \\
    &= \sigma(\tau y - y) + \sigma y -y \\
    &= \sigma\varphi(\tau) + \varphi(\sigma)
\end{align*}
So $\varphi$ is a homomorphism exactly when the action of $G_k$ on 
$A[n]$ is trivial. Moreover, there is a number field $L/k$ such that 
$G_L\subset G_k$ fixes $y$. In particular, $\varphi(G_L)=0$, i.e. the map 
$\varphi:G_k\to A[n]$ is continuous. Suppose we choose some $y'$ distinct from 
$y$ with $x=n\cdot y'$. We could define $\varphi':G_k\to A[n]$ by 
$\sigma\mapsto \sigma y'-y'$. Since $n(y-y')=0$, we have $y'-y\in A[n]$, hence 
$y'=y+\alpha$ for some $\alpha\in A[n]$. We now have 
\begin{align*}
  \varphi'(\sigma) &= \sigma y'-y' \\
    &= \sigma(y+\alpha) - (y+\alpha) \\
    &= \sigma y - y + \sigma\alpha-\alpha \\
    &= \varphi(\sigma) + \sigma \alpha-\alpha
\end{align*}
Maps $G_k\to A[n]$ of the form $\sigma\mapsto \sigma \alpha-\alpha$ will be 
called \emph{coboundaries}. 

Suppose we have another point $x'\in A(k)$. Choose a $y'$ with $x'=n y'$. Then 
$x+x'=n(y+y')$, and the point $x+x'$ gives rise to a map $G_k\to A[n]$, 
$\sigma\mapsto \sigma(y+y')-(y+y')$; this map is just $\varphi+\varphi'$, where 
$\varphi':\sigma\mapsto \sigma y'-y$. 

\begin{definition}
Let $G$ be a profinite group, $M$ a discrete $G$-module. The group $Z^1(G,M)$ 
of \emph{$1$-cocycles} consists of continuous maps $\varphi:G\to M$ such that 
$\varphi(\sigma\tau)=\sigma\varphi(\tau)+\varphi(\sigma)$. The group $B^1(G,M)$ 
of \emph{$1$-coboundaries} consists of continuous maps $\varphi:G\to M$ of the 
form $\sigma\mapsto \sigma\alpha-\alpha$ for some $\alpha\in M$. The 
\emph{first cohomology of $G$ with coefficients in $M$} is 
\[
  \h^1(G,M) = Z^1(G,M) / B^1(G,M)
\]
\end{definition}
One can prove using a canonical projective resolution of $M$ that this agrees 
with the derived functor definition.One can check directly that if 
$0\to M'\xrightarrow f M\xrightarrow g M''$ is an exact sequence of 
$G_k$-modules, then there is a natural exact sequence:
\[\xymatrix{
  0 \ar[r] 
    & {M'}^G \ar[r]^-f
    & M^G \ar[r]^-g
    & {M''}^G \ar[r]^-\delta
    & \h^1(G,M') \ar[r]^-{f_*}
    & \h^1(G,M) \ar[r]^-{g_*}
    & \h^1(G,M'')
}\]
where $\delta(x)$ is defined as follows. Choose a lift $\tilde x$ in 
$M$, and let $\delta(x)(\sigma) = f^{-1}(\sigma \tilde x - \tilde x)$. One can 
check that this is a cocycle, and that choosing a different $\tilde x$ changes 
$\delta(x)(\sigma)$ by a coboundary. 

If $G$ is a discrete group, then the cohomology $\h^\bullet(G,M)$ can be 
interpreted as an $\operatorname{Ext}$-group. It is easy to see that the 
category of $G$-module is equivalent to the category of $\dZ[G]$-modules, and 
that $M^G\simeq \hom_{\dZ[G]}(\dZ,G)$. It follows that 
$\h^\bullet(G,M)\simeq \operatorname{Ext}_{\dZ[G]}^\bullet(\dZ,M)$. If $G$ is a 
profinite group, then $\dZ[G]$ is the wrong ring to use. Instead, one considers 
the \emph{completed group ring} 
\[
  \dZ\llbracket G\rrbracket = \varprojlim_{\substack{N\triangleleft G \\ N\text{ open}}} \dZ[G/N]
\]
where we give each $\dZ[G/n]$ the discrete topology and 
$\dZ\llbracket G\rrbracket$ the inverse limit topology. The category of 
discrete $G$-modules with continuous action is equivalent to the category of 
discrete $\dZ\llbracket G\rrbracket$-modules with continuous action, 
$M^G\simeq \hom_{\dZ\llbracket G\rrbracket}(\dZ,M)$, whence 
$\h^\bullet(G,M) \simeq \operatorname{Ext}_{\dZ\llbracket G\rrbracket}^\bullet(\dZ,M)$. 

In the case that $G=G_k$, one can interpret the groups $\h^\bullet(G,M)$ as a 
special case of \'etale cohomology. Recall that a morphism $f:X\to S$ of 
schemes is \emph{\'etale} if it is flat and unramified. The \emph{\'etale 
site} of $S$, denoted $\et S$, is the full subcategory of $\mathsf{Sch}_S$ 
consisting of $X\to S$ that are \'etale. A collection $\{f_i:U_i\to X\}$ in 
$\et S$ is a \emph{cover} if the images of the $f_i$ cover $X$. With this 
notion of a cover, $\et S$ is a (subcanonical) site, so we can talk about 
sheaves and cohomology on $\et S$. There are two key examples. If $k$ is a 
field, write $\et k$ for $\et{\spec(k)}$. Then the objects of $\et k$ are all 
of the form $\spec(L_1)\sqcup \cdots \sqcup \spec(L_n)\to \spec(k)$ for a 
finite family of separable field extensions $L_1,\dots,L_n$ of $k$. One can 
check that the category $\sh(\et k)$ of abelian sheaves on $\et k$ is 
equivalent to the category of discrete $G_k$-modules, via the functor 
$\sF\mapsto \sF_{\bar k} = \varinjlim_{L/k} \sF(\spec L)$, where $L$ ranves 
over all finite Galois extensions of $k$. If $M$ is a $G_k$-module, then there 
is a corresponding \'etale sheaf $\widetilde M$, determined by 
$\widetilde M(\spec L) = M^{G_L}$. Since 
$M^G\simeq \h^0(\et k,\widetilde M)$, we obtain that 
$\h^\bullet(G_k,M) \simeq \h^\bullet(\et k, \widetilde M)$. For more details, 
see \cite[I 2.4]{de77}. 

In our case, the exact sequence 
$0\to A[n]\to A(\bar k) \xrightarrow n A(\bar k) \to 0$ gives rise to a long 
exact sequence 
\[\xymatrix@=0.5cm{
  0 \ar[r] 
    & A[n]^{G_k} \ar[r] 
    & A(k) \ar[r]^-n 
    & A(k) \ar[r]^-\delta 
    & \h^1\left(G_k,A[n]\right) \ar[r] 
    & \h^1\left(G_k,A(\bar k)\right) \ar[r] 
    & \h^1\left(G_k, A(\bar k)\right) \ar[r] 
    & \cdots
}\]
It follows that we have an exact sequence 
\[\xymatrix{
  0 \ar[r] 
    & A(k) / n \ar[r]^-\delta
    & \h^1\left(G_k,A[n]\right) \ar[r] 
    & \h^1\left(G_k,A(\bar k)\right)[n] \ar[r]
    & 0
}\]
We will try to prove that $A(k)/ n$ is finite by embedding it into a group 
we know is finite. Unfortunately $\h^1(G_k, A[n])$ is infinite, so we cannot 
just use the above exact sequence show that $A(k)/n$ is finite. 

In general, suppose $G$ is a (commutative) group scheme over $k$. For example, 
$G$ could be the multiplicative group $\dG_m$, and abelian variety $A$. If 
$G$ is any commutative group scheme over $k$, we will use $G[n]$ to denote the 
fiber product $G\times_G 0$, where the map $G\to G$ is ``multiply by $n$.'' 
This conflicts with our earlier convention that $A[n]=A(\bar k)[n]$, but 
no confusion should arise from this. The group $G(\bar k)$ is 
a $G_k$-module, so we can consider the cohomology groups 
$\h^\bullet\left(G_k, G(\bar k)\right)$. We know that these are isomorphic to 
the \'etale cohomology groups 
$\h^\bullet\left(\et k, \widetilde{G(\bar k)}\right)$, and one can check quite 
easily that $\widetilde{G(\bar k)}$ is just $G$, regarded as a sheaf on $\et k$ 
via its functor of points. It follows that 
$\h^\bullet\left(G_k, G(\bar k)\right) = \h^\bullet(\et k, G)$, and we will 
pass between the two without comment in the future. 

To simplify the notation, we will often write $k$ for $\et k$, i.e. 
$\h^\bullet(k,G) = \h^\bullet(\et k,G)$. In this context, Hilbert's 
\emph{theorem 90} says that for $k$ a field, $\h^1(k,\dG_m) = 0$. If we write 
$\mu_n = \dG_m[n]$, then \emph{Kummer theory} starts with the short exact 
sequence $1\to \mu_n\to \dG_m\xrightarrow n \dG_m \to 1$ and uses Hilbert's 
theorem 90 together with the long exact sequence in sheaf cohomology to derive 
$\h^1(k,\mu_n) = k^\times / (k^\times)^n$. 

There is an alternate description of $\h^1(k,A)$. If $G$ is an arbitrary 
commutative algebraic group over $k$, a \emph{principal homogeneous space} 
(also called a \emph{torsor}) for $G$ over $k$ is a nonempty variety $X/k$ 
together with a morphism $G\times X\to X$ which, on $\bar k$-valued points, is 
a simply transitive group action. That is, if we write $g+x$ for the 
image of $(g,x)$ in $X$, we require that 
\begin{itemize}
  \item $g+(h+x) = (g+h)+x$ 
  \item $0+x = x$
  \item for all $x,y\in X(\bar k)$, there is a unique $g\in G(\bar k)$ such 
    that $g+x = y$
\end{itemize}
more generally, if $S$ is a scheme and $\sG$ is an abelian sheaf on $\et S$, a 
\emph{torsor} for $\sG$ is a sheaf of sets $\sT$ with a group action 
$\sG\times \sT\to\sT$ that, \'etale-locally on $S$, is isomorphic to $\sG$ as 
a sheaf with left $\sG$-action. Two torsors $\sT,\sT'$ are isomorphic if there 
is a sheaf isomorphism $\sT\to \sT'$ that commutes with the action of $\sG$. 
One can show (see e.g. \cite[IV 1.1]{de77}) that $\h^1(\et S,\sG)$ is 
naturally isomorphic as a pointed set to the set of isomorphism classes of 
$\sG$-torsors. 

Thus if $G$ is a commutative algebraic group over $k$, there is a natural 
bijection between the set of isomorphism classes of $G$-torsors and 
$\h^1(k,G)$. There is a non-abelian version of this. If $\sG$ is an arbitrary 
sheaf of groups over $\et S$, then one can still define the notion of a 
$\sG$-torsor. An identical theorem holds, except that one must define the 
``cohomology set'' $\h^1(\et S,\sG)$. For details, see \cite{sk01}. There is a 
non-abelian version of Hilbert's theorem 90: it says that 
$\h^1(k,\text{SL}_n) = \h^1(k,\text{GL}_n) = 0$ for all $n$ \cite[X 1]{se79}. 










% class on 09-19-2013
\section{Selmer groups and weak Mordell-Weil}

Recall that if $G$ is a profinite group (e.g $G_k$ for some field $k$) and $M$ 
is a discrete abelian group with continuous $G$-action, we directly defined the 
first cohomology group $\h^1(G,M) = Z^1(G,M) / B^1(G,M)$, where 
\[
  Z^1(G,M) = \{\varphi:G\to M\text{ continuous}: \varphi(\sigma\tau) = \sigma \varphi(\tau)+\varphi(\sigma)\}
\]
and $B^1(G,M)$ consisted of all $\varphi:G\to M$ of the form 
$\sigma\mapsto \sigma x-x$. Note that if $G$ acts trivially on $M$, then 
$\h^1(G,M) = \hom_\text{cts}(G,M)$. If $f:M\to M'$ is $G$-equivariant, then 
there is an obvious map $f_*L\h^1(G,M)\to \h^1(G,M')$ given by 
$f_*[\varphi] = [f\circ \varphi]$. Moreover, if $f:G'\to G$ is a continuous 
group homomorphism, then we have a map $f^*:\h^1(G,M) \to \h^1(G',M)$ given 
by $f^*[\varphi] = \varphi\circ f$, where we regard $G'$ as acting on $M$ via 
$f$. 

Let $k$ be a number field, $A$ be an abelian variety over $k$, and 
$n\geqslant 2$. The short exact sequence $0\to A[n]\to A\xrightarrow n A \to 0$ 
of group schemes induces an exact sequence 
\[\xymatrix{
  0 \ar[r]  
    & A(k)/n \ar[r] 
    & \h^1\left(k,A[n]\right) \ar[r] 
    & \h^1(k,A)[n] \ar[r] 
    & 0
}\]
We are trying to prove that $A(k)/n$ is finite. Since $\h^1\left(k,A[n]\right)$ 
can be infinite, we'll need to do some work to show this. 

\begin{example}
Let $K=\dQ$, and let $E$ be the elliptic curve defined by 
$y^2=(x-a)(x-b)(x-c)$ for distinct $a,b,c\in \dQ$. Then 
$E[2](\bar\dQ) = \{0,(a,0),(b,0),(c,0)\}$. Thus 
\begin{align*}
  \h^1(\dQ,E[2]) &= \hom(G_\dQ,E[2]) \\
    &= \hom(G_\dQ,\dZ/2\times \dZ/2) \\
    &= \hom(G_\dQ,\dZ/2) \times \hom(G_\dQ,\dZ/2)
\end{align*}
This is easily seen to be infinite (either using global class field theory, or 
by noting that $\dQ$ has lots of Galois extensions of degree $2$.) In fact, 
using Kummer theory, one can show that 
$\h^1(\dQ,E[2]) = \bigoplus_{\aleph_0} \dZ/2$. 
\end{example}

Our goal is to find a finite subgroup of $\h^1(k,A[n])$ containing $A(k)/n$. 
We haven't really used the fact that $k$ is a number field yet -- everything so 
far works for any perfect field. That changes when we start looking at 
completions of $k$. 

As before, let $k$ be a number field, and let $k_v$ denote the completion of 
$k$ at a place $v$. One can show that $k_v$ will either be $\dR$, $\dC$, or a 
finite extension of some $\dQ_p$. Choose $\overline{k_v}\supset k$; this gives 
a homomorphism $G_{k_v} \to G_k$, where $\sigma\mapsto \sigma|_{\bar k}$. It 
turns out that this is injective, but we will prove this later. As an example, 
if $k=\dQ$, $k_v=\dR$, then $G_{\dR}=\{1,c\}$ where $c:\dC\to \dC$ is complex 
conjugation. The image of $c$ in $G_\dQ$ is some element of order two. 

The functoriality of $\h^\bullet(-,-)$ applied to the map $G_{k_v} \to G_k$ 
gives us a map $\h^1(k,A[n]) \to \h^1(k_v,A[n])$, where we regard $A[n]$ as a 
group scheme over $k_v$ by base extension. We now have a commutative diagram: 
\[\xymatrix{
  0 \ar[r] 
    & A(k)/n \ar[r] \ar[d] 
    & \h^1(k,A[n]) \ar[r] \ar[d]^-\beta 
    & \h^1(k,A)[n] \ar[r] \ar[d] 
    & 0 \\
  0 \ar[r] 
    & \displaystyle\prod_v A(k_v)/n \ar[r]^-\alpha 
    & \displaystyle\prod_v \h^1(k_v,A[n]) \ar[r] 
    & \displaystyle\prod_v \h^1(k_v,A)[n] \ar[r] 
    & 0
}\]
The \emph{$n$-Selmer group} of $A$ over $k$ is 
\begin{align*}
  \sel_n(A) = \{x\in \h^1(k,A[n]) : \beta(x) \in \im(\alpha)\} 
    = \ker\left(\h^1(k,A[n]) \to \prod_v \h^1(k_v,A)[n]\right)
\end{align*}
Similarly, we define the \emph{Tate-Shafarevich group} of $A$ by the exact 
sequence 
\[\xymatrix{
  0 \ar[r] 
    & \sha(A) \ar[r] 
    & \h^1(k,A) \ar[r]
    & \displaystyle\prod_v \h^1(k_v,A)
}\]
Putting these two definitions together, we obtain a short exact 
sequence 
\[\xymatrix{
  0 \ar[r] 
    & A(k)/n \ar[r] 
    & \sel_n(A) \ar[r] 
    & \sha(A)[n] \ar[r] 
    & 0
}\]
We will soon prove that $\sel_n(A)$ is finite, hence $A(k)/n$ and 
$\sha(A)[n]$ are finite. 

\begin{question}[Tate-Shafarevich]
If $A$ is an abelian variety over a number field $k$, is $\sha(A)$ finite?
\end{question}
This is currently open. A positive answer would show that for $n$ sufficiently 
large, $A(k)/n \simeq \sel_n(A)$. In particular, this would imply that for $p$ 
large enough, $\operatorname{rk}(A) = \dim_{\dF_p} \sel_p(A)$, where as before 
$\operatorname{rk}(A) = \operatorname{rk}_\dZ A(k)$ is the algebraic rank of 
$A$. 

\begin{remark}
The Selmer groups $\sel_n(A)$ are effectively computable. If $\sha(A)$ were 
always finite, then $A(k)$ would be computable. 
\end{remark}





\section{Places of global fields}

If $k$ is a number field, we already used (without defining) the notion of a 
\emph{place} of $k$. In this section, we will see that $k$ comes with a lot of 
extra structure which will be used later on. Let's start with places. 

\begin{definition}
A \emph{local field} is a topological field that is locally compact as a 
topological space. 
\end{definition}

Let $k$ be a local field. Then the additive group of $k$ is a locally compact 
group, so it has a nontrivial \emph{Haar measure}, i.e. a 
translation-invariant Borel measure $\mu$. For $\alpha\in k$, the measure 
$\alpha^*\mu$ defined by $\alpha^* \mu(S) = \mu(\alpha S)$ is easily seen to 
be translation-invariant as well. It is known that $\mu$ is unique up to 
scalar, so there is a real number, denoted $|\alpha|$, such that 
$\alpha^*\mu = |\alpha|\mu$. One can prove that the function 
$|\cdot|:k\to \dR_{\geqslant 0}$ is an \emph{absolute value}. That is, 
\begin{enumerate}
  \item $|x|=0$ if and only if $x=0$
  \item $|x y| = |x|\cdot |y|$
  \item $|x+y|\leqslant |x|+|y|$
\end{enumerate}
It turns out that $|\cdot|$ induces the topology that $k$ already has, and 
that $k$ is complete with respect to $|\cdot|$. 

Local fields can be completely classified. If the strict triangle inequality 
holds, i.e. $|x+y|\leqslant \sup\{|x|,|y|\}$ for all $x,y\in k$, we say that 
$k$ is \emph{non-archimedean}. If $k$ is not non-archimedean, we say it is 
\emph{archimedean}. If $k$ is archimedean, one can prove that $k$ has 
characteristic zero, so $\dQ\subset k$. The absolute value on $k$ induces one 
on $\dQ$, and it is a theorem that the only archimedean absolute value on 
$\dQ$ is the usual one. Thus $\dR\subset k$. It is a general theorem that $k$ 
can only be locally compact if $[k:\dR]<\infty$, from which it follows that 
either $k=\dR$ or $k=\dC$. 

If $k$ is non-archimedean of characteristic $p$, then one can prove that 
$k=\dF_q\lau t$ for some finite field $\dF_q$, where $q=p^r$. If $k$ is 
non-archimedean of characteristic zero, then once again $\dQ\subset k$. It is 
known (Otrowski's theorem) that the only non-archimedean absolute values on 
$\dQ$ are of the form $|\cdot|_p$ for primes $p$, where $|x|_p=p^{-v_p(x)}$. 
Here $v_p:\dQ^\times \to \dZ$ is the unique homomorphism with 
$v_p(p)=1$, $v_p(n)=0$ for $p\nmid n$. If we write $\dQ_p$ for the completion 
of $\dQ$ with respect to $|\cdot|_p$, then $k$ contains some $\dQ_p$. Once 
again a general theorem shows that $[k:\dQ_p]<\infty$. To summarize, local 
fields are one of the following:
\begin{itemize}
  \item $\dR$ or $\dC$
  \item $\kappa\lau t$ for some finite field $\kappa$
  \item a finite extension of $\dQ_p$
\end{itemize}

If $k$ is a non-archimedean local field, we write 
$\fo_k=\{x\in k:|x|\leqslant 1\}$ and $\fp_k = \{x\in k:|x|<1\}$. It turns 
out that $\fo_k$ is a complete discrete valuation ring with maximal ideal 
$\fp_k$. We denote the residue field by $\kappa_k=\fo_k/\fp_k$. When $k$ is 
understood, we write $\fo,\fp,\kappa$ instead of $\fo_k,\fp_k,\kappa_k$. 
Choose a separable closure $k^s$ of $k$. Because the field $k$ is 
\emph{henselian} ($|\cdot|$ has a unique extension to $k^s$), the integral 
closure $\fo_{k^s}$ of $\fo_k$ in $k^s$ is a local ring (no longer noetherian) 
and elements of $G_k$ preserve $|\cdot|$. The field 
$\fo_{k^s}/\fp_{k^s}$ is separably closed, so we get a map 
$G_k\to G_\kappa$, given by $\sigma\mapsto \bar\sigma$, where 
$\bar\sigma(\bar x)=\overline{\sigma x}$. The kernel is called the 
\emph{inertia group} of $k$, and denoted $I_k$. 

\begin{definition}
A \emph{global field} is either a finite extension of either $\dQ$ or 
$\dF_p(t)$ for some prime $p$. 
\end{definition}
A \emph{place} of a global 
field $k$ is an equivalence class of embeddings $k\hookrightarrow K$, where 
$K$ is a local field such that the image of $k$ is dense. Two such 
embeddings are equivalent if they are (topologically) isomorphic over $k$. 
We will use the letter $v$ to denote places of $k$, and denote a choice of 
representative by $k_v$. If $k_v$ is non-archimedean, we call $v$ 
\emph{finite}, otherwise it is \emph{infinite}. For the remainder, let $v$ be 
a finite place of $k$. 

The absolute value on $k_v$ induces one on $k$, which we will denote by 
$|\cdot|_v$. If $v$ is non-archimedean (i.e. $k_v$ is non-archimedean) then we 
will also use $v$ to denote the valuation on $k$ induced by the canonical 
valuation on $k_v$. We will write $\fo_v$, $\fp_v$, $\kappa_v$ instead of 
$\fo_{k_v}$\ldots. We can choose $k_v^s\supset k^s$, in which case restriction 
induces a continuous homomorphism $G_{k_v} \to G_k$. We will prove later that 
this is injective. The image is often denoted $G_v$, and the image of 
$I_{k_v}$ inside $G_v$ will be written $I_v$. Note that $G_v$, as a subset of 
$G_k$, is only well defined up to conjugacy. 

There is a lot more to be said about global fields, but we will conclude with 
the \emph{product formula}. Given the canonical absolute value $|\cdot|_v$ 
associated with a place, one can prove that 
\[
  \prod_v |x|_v = 1
\]
This property actually characterizes global fields -- see \cite{ar45}. For 
more details on local and global fields, see \cite{we95}. 










% class on 09-24-2013
\section{Crash course in algebraic number theory}

Let $k$ be a number field, i.e. a finite extension of $\dQ$. Let $\fo_k$ be the 
\emph{ring of integers} of $k$, that is, $\fo_k$ is the integral closure of 
$\dZ$ in $k$. The ring $\fo_k$ is a dedekind domain. Thus if $\fa\subset \fo_k$ 
is a nonzero ideal, we have a factorization $\fa=\fp_1^{e_1}\dotsm \fp_r^{e_r}$ 
where the $\fp_i\subset\fo_k$ are prime (hence maximal) ideals, and each 
$e_i\geqslant 1$. This factorization is unique up to reordering if we require 
that the $\fp_i$ be distinct. 

For a prime $\fp\subset \fo_k$, we write (as before) $\kappa_\fp = \fo_k/\fp$ 
for the \emph{residue field} of $\fp$. The field $\kappa_\fp$ is finite because 
it is finitely generated (as a ring) over its prime field. There is a unique 
homomorphism $v_\fp:k^\times \twoheadrightarrow \dZ$ such that for 
$a\in \fo_k\setminus 0$, we have $(a)=\fp^{v_\fp(a)}\cdot \fb$ with 
$(\fb,\fp)=1$. This gives us an absolute value 
\[
  |a|_\fp = \begin{cases}
              0 & \text{if $a=0$} \\
              (\# \kappa_\fp)^{-v_\fp(a)} & \text{otherwise}
            \end{cases}
\]
Completing $k$ with respect to this absolute value, we get a local field 
$k_\fp$. Our valuation (and absolute value) extend by continuity to a 
valuation $v_\fp:k_\fp^\times\to\dZ$ and absolute value 
$|\cdot|_\fp:k_\fp\to\dR_{\geqslant 0}$. 

Let $L/k$ be a finite extension, $\fp\subset \fo_k$ a prime ideal. The ideal 
$\fp\fo_L$ factors uniquely as 
$\fq_1^{e(\fq_1/\fp)}\dotsm\fq_r^{e(\fq_r/\fp)}$, where the $\fq_i\subset\fp_L$ 
are prime. For example, if $L=\dQ(i)$, then $2=-i(1+i)^2$ and $5=(1+2i)(1-2i)$. 
One can show that 
\begin{align*}
  2\fo_L &= ((1+i)\fo_L)^2 \\
  3\fo_L &= 3\fo_L \\
  5\fo_L &= ((1+2i)\fo_L)\cdot ((1-2i)\fo_L)
\end{align*}
are prime factorizations in $\fo_L$. One says that $\fp$ is \emph{unramified} 
in $L$ if $e(\fq_i/\fp)=1$ for all $i$. It is an easy theorem that only 
finitely many primes can ramify. 

Now assume $L/k$ is Galois. The action of the galois group $G=\gal(L/k)$ 
preserves $\fo_L$, fixing $\fo_k$. This action does \emph{not} fix ideals in 
$\fo_L$. In fact, if $\fq_1,\dots,\fq_r$ are the primes lying above 
$\fp\subset \fo_k$, then $G$ acts transitively on $\{\fp_1,\dots,\fp_r\}$, 
from which we see that each $e(\fq_i/\fp)$ is the same integer, denoted 
$e_\fp$. Fix $\fq=\fq_1$. The \emph{decomposition group} of $\fq/\fp$ is 
\[
  D(\fq/\fp) = \{\sigma\in \gal(L/k) : \sigma(\fq) = \fq\}
\]
There is a canonical homomorphism 
$D(\fq/\fp) \to \gal(\kappa_\fq/\kappa_\fp)$ given by ``reduce $\sigma$ modulo 
$\fp$.'' This gives us an exact sequence 
\[\xymatrix{
  1 \ar[r] 
    & I(\fq/\fp) \ar[r] 
    & D(\fq/\fp) \ar[r] 
    & \gal(\kappa_\fq/\kappa_\fp) \ar[r] 
    & 1
}\]
(One can prove that the map on the right is surjective.) So the \emph{inertia 
group} of $\fq/\fp$, denoted $I(\fq/\fp)$, is the subgroup of $D(\fq/\fp)$ 
consisting of automorphisms whose action is trivial modulo $\fq$. Choosing 
$\fq=\fq_i$ for some $i\ne 1$ gives a $D(\fq_i/\fp)$ that is conjugate to 
$D(\fq/\fp)$. We will often write $D_\fp$ and $I_\fp$, keeping in mind that 
they are only well-defined up to conjugacy. We will use the fact that 
$\# I_\fp = e_\fp$. So $\fp$ is unramified in $L$ if and only if 
$I_\fp = 1$. 

Choosing $\fq$ lying over $\fp$, we can complete $L$ and $k$ to get an 
extension $L_\fq/k_\fp$ of local fields. We have seen that restriction 
gives a map $\gal(L_\fq/k_\fp) \to \gal(L/k)$. It turns out that this map is an 
isomorphism onto the image $D(\fq/\fp)\subset \gal(L/k)$. We'll write 
$I(L_\fq/k_\fp)$ for the inverse image of $I(\fq/\fp)$ in 
$\gal(L_\fq/k_\fp)$. It can be defined directly in exactly the same manner as 
$I(\fq/\fp)$. 

Passing to the algebraic closure of $k_\fp$, we can consider the absolute 
Galois group 
\[
  G_{k_\fp} = \varprojlim_{L_\fq\supset k_\fp} \gal(L_\fq/k_\fp)
\]
where $L_\fq$ ranges over all finite Galois extensions of $k_\fp$. The group 
$G_{k_\fp}$ has a distinguished subgroup $I_\fp$, which is the inverse limit 
\[
  I_\fp = \varprojlim_{L_\fq/k_\fp} I(L_\fq/k_\fp)
\]
Our exact sequence 
\[\xymatrix{
  1 \ar[r] 
    & I_\fp \ar[r] 
    & G_{k_\fp} \ar[r] 
    & \gal(\overline{\kappa_\fp}/\kappa_\fp) =\hat\dZ \ar[r] 
    & 1
}\]
extends to a filtration of $G_{k_\fp}$ by normal closed subgroups whose 
successive quotients are abelian. Once again, recall that there is a canonical 
embedding $G_{k_\fp}\hookrightarrow G_k$ via an embedding 
$\bar k\hookrightarrow \overline{k_\fp}$. 










\section{Reduction of abelian varieties}

Let $A$ be an abelian variety over a local field $k_\fp$. Let $\fo_\fp$ be the 
ring of integers of $k_\fp$, i.e. $\fo_\fp=\{x\in k_\fp:|x|_\fp\leqslant 1\}$. 
The ideal $\fp\fo_\fp$ is the unique maximal ideal of $\fo_\fp$, and it turns 
out that $\fp\fo_\fp = \{x\in k_\fp:|x|_\fp<1\}$. In an abuse of notation, we 
write $\fp$ for $\fp\fo_\fp$. 

\begin{definition}
We say that a variety $X/k_\fp$ has \emph{good reduction} if there is a smooth 
proper model $\cX/\fo_\fp$ .
\end{definition}
That is, there is a smooth proper scheme $\cX$ over $\fo_\fp$ such that the 
following diagram is cartesian:
\[\xymatrix{
  X \ar[r] \ar[d]  
    & \cX \ar[d] \\
  \spec(k_\fp) \ar[r] 
    & \spec(\fo_k)
}\]
We write $X_\fp$ for $\cX\times_{\spec(\fo_k)}\spec(\kappa_\fp)$, and call 
$X_\fp$ the \emph{reduction of $X$ modulo $\fp$}. 

One can show that if $A$ is an abelian variety over $k_\fp$ with good 
reduction, then $A_\fp$ is independent of the choice of $\cA$, that $\cA$ gets 
the structure of an abelian scheme over $\fo_k$, and that $A_\fp/\kappa_\fp$ is 
an abelian variety. 

\textbf{(N\'eron models)}

\begin{example}
Let $E:y^2=x^3+a x+b$, where $a,b\in \dZ$ and $\Delta=-16(4 a^3+27b^2)\ne 0$. 
If $p\nmid \Delta$, then $E/\dQ_p$ has good reduction, and $E_p/\dF_p$ is given 
by the reduction of our original equation modulo $p$. 
\end{example}

There is a reduction map $A(k_\fp)\to A_\fp(\kappa_\fp)$ which is a group 
homomorphism. This is the composite 
\[
  A(k_\fp)=\cA(\fo_\fp) \to \cA(\kappa_\fp) = A_\fp(\kappa_\fp)
\]
To see that $A(k_\fp)=\cA(\fo_\fp)$, think of $A$ as being a subset of some 
projective space $\mathbb{P}^N$. For a point
$x=(x_0:\cdots:x_N)\in \mathbb{P}^N(k_\fp)$, we can scale $x$ be the 
denominators of the $x_i$ to get a model 
$x=(x_0:\cdots:x_N)\in\mathbb{P}^N(\fo_\fp)$. We can even get a model with 
some $x_i\not\equiv 0\mod\fp$, and the image of $x$ in 
$\mathbb{P}^N(\kappa_\fp)$ is in $A_\fp(\kappa_\fp)$. By Hensel's lemma, the 
map $A(k_\fp) \to A_\fp(\kappa_\fp)$ is a surjection. The kernel is a pro-$p$ 
group, where $p$ is the characteristic of $\kappa_\fp$. In fact, the kernel is 
a $p$-adic Lie group. 

We can extend our reduction map to algebraic closures, getting a homomorphism 
$A(\overline{k_\fp}) \to A_\fp(\overline{\kappa_\fp})$, that has a pro-$p$ 
kernel. Choose an integer $n\geqslant 2$ with $p\nmid n$. The map 
$A(\overline{k_\fp})[n] \to A_\fp(\overline{\kappa_\fp})[n]$ is an isomorphism 
because both groups have the same cardinality ($n^2$) and the kernel is 
pro-$p$. In that isomorphism both groups have a Galois action -- $G_{k_\fp}$ on 
the left and $G_{\kappa_\fp}=\hat\dZ$ on the right. The map is compatible with 
the Galois action, so in particular, the inertia group $I_\fp$ acts trivially 
on $A(\overline{k_\fp})[n]$. 

Let $A/k_\fp$ be an abelian variety with good reduction. Recall we had a map 
$\delta:A(k_\fp)/n A(k_\fp) \hookrightarrow \h^1(k_\fp,A[n])$ defined as 
follows. For $x\in A(k_\fp)$, choose $y\in A(\overline{k_\fp})$ such that 
$n\cdot y=x$. We define the $1$-cocycle $\varphi=\delta(x)$ by 
$\sigma\mapsto \sigma y - y$. For $\sigma\in I_\fp$, the elements 
$\sigma y$ and $y$ have the same image in $A_\fp(\overline{\kappa_\fp})$, hence  
$\sigma y - y\in A(\overline{k_\fp})[n]$ has trivial image modulo $\fp$. It 
follows that $\sigma y-y=0$ since it is an $n$-torsion point that is $0$ 
modulo $\fp$. This tells us that $\varphi(\sigma) = 0$ for all 
$\sigma\in I_\fp$, i.e. $\varphi(I_\fp) = 0$. 

\begin{lemma}
Let $A$ be an abelian variety over a number field $k$. With the above notation, 
$\varphi(I_\fp) = 0$ for all $\fp\subset \fo_k$ of good reduction for $A$. 
\end{lemma}

If we let $S$ be the finite set of primes for which $A$ has bad reduction, we 
will show that the group
\[
  \h_S^1(k,A[n]) = \{[\varphi]\in \h^1(k,A[n]) : \varphi(I_\fp) = 0\forall \fp\in S\}
\]
is finite. 










\bibliographystyle{amsplain}
\bibliography{7390-sources}

\end{document}

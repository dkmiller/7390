\documentclass{article}

\usepackage{7390-style}

\title{Arithmetic of curves}
\author{Daniel Miller
  \thanks{based on a course taught by David Zywina at Cornell}}
\date{fall 2013}

\begin{document}
\maketitle
\tableofcontents




\newpage
\section*{Disclaimer}

These notes originated in a course on the arithmetic of curves taught by David 
Zywina at Cornell. However, a significant amount of material (including, no 
doubt, many errors) has been added since then, so they are far from an exact 
reflection of what he covered in class. Moreover, the notation has been changed 
in many places (sometimes significantly) as has the order in which material is 
covered. Most significantly, the tone of these notes differs drastically 
from the perspective David took in class, with the notes being much more 
cohomological and scheme-theoretic than David's more elementary (and 
pedagogically correct) approach. Any errors in these notes are my fault. 





\include{7390-1_jacobians}
\include{7390-2_mordell-weil}
\include{7390-3_finite-fields}





\section{Birch and Swinnerton-Dyer conjecture}

Consider an elliptic curve $E$ over $\dQ$. It has a model of the form 
$y^2=x^3+a x+b$ with $a,b\in \dZ$ and the discriminant 
$\Delta=-16(4 a^3+27 b^2)\ne 0$. The Mordell-Weil theorem (proved in this case 
by Mordell) tells us that $E(\dQ)$ is finitely generated. By basic algebra, 
we can write $E(\dQ) = E(\dQ)_\text{tors}\oplus \dZ^r$ where 
$E(\dQ)_\text{tors}$ is finite, and $r=\rank E(\dQ)$ is the algebraic rank of 
$E$ (over $\dQ$). The group $E(\dQ)_\text{tors}$ can be computed. One way is to 
look at the map $E(\dQ)_\text{tors}\to E(\dF_p)\times E(\dF_{p'})$, which is 
injective when $p$ and $p'$ are distinct primes of good reduction. For 
example, we could choose $p\ne p'$, with both not dividing $\Delta$. 

The group $E(\dQ)$ is one of a finite list. In fact, there is the following 
deep theorem of Mazur (conjectured by Ogg).

\begin{theorem}
Let $E$ be an elliptic curve over $\dQ$. Then $E(\dQ)_\textnormal{tors}$ is 
isomorphic to one of the following:
\[
  \begin{array}{ll}
    \dZ/n & \text{with $n=1,\dots,10$ or $n=12$} \\
    \dZ/n\oplus \dZ/2 & \text{with $n=1,\dots,4$}
  \end{array}
\]
\end{theorem}
\begin{proof}
See \cite[III.5.1]{ma77}. Essentially, Mazur classifies rational points on the 
modular curves $X_0(N)$. 
\end{proof}

Each of these possibilities occur infinitely often.

Unlike the situation with $E(\dQ)_\text{tors}$, where everything is computable 
and well-understood, there is no known algorithm to compute the rank of an 
elliptic curve. If $\sha(E)$ is finite, then there is an algorithm, but the 
finiteness of $\sha(E)$ is not known in general. 

The vague idea of the Birch and Swinnerton-Dyer conjecture (henceforth BSD) is 
as follows. Suppose $E(\dQ)$ has high rank. Then for $p$ a prime of good 
reduction, we have a map $E(\dQ) \to E(\dF_p)$. (Scheme-theoretically, 
$E(\dF_p)$ doesn't make sense. We set $E(\dF_p) = \cE(\dF_p)$, where 
$\cE$ is the N\'eron model of $E$ over $\dZ_{(p)}$. Since 
$E(\dQ) = E(\dZ)$, we are really looking at the map 
$E(\dZ) \to \cE(\dF_p)$.) The group $E(\dF_p)$ has order 
$p+1-a_p(E)$, where $a_p(E) = a(\cE_{\dF_p})$, and 
$|a_p(E)|\leqslant 2\sqrt p$. The expectation is for $E(\dF_p)$ to be 
``slightly larger'' than average, given that the map 
$E(\dQ) \to E(\dF_p)$ gives us some points ``for free.'' This effect turns out 
to be very subtle. 

Define the function $\pi_E$ on $\dR_{\geqslant 0}$ by 
\[
  \pi_E(x) = \prod_{p\leqslant x \text{ good}} \frac{\# E(\dF_p)}{p} \text{.}
\]
We hope that $r=\rank E$ can be detected from the growth of $\pi_E$. In the 
early 60s, Swinnerton-Dyer used a computer to get numerical data on these 
types of problem. He and Birch conjectured the following \cite[A]{bsd65}: 
\[
  \lim_{x\to \infty} \frac{\log \pi_E(x)}{\log \log x} = r
\]
One could also conjecture that $\pi_E(X) \sim C (\log x)^r$ as $x\to \infty$ 
for some constant $C$. The function $\pi_E$ is hard to work with. Instead, we 
will follow standard practice in number theory and introduce an $L$-function. 

\begin{definition}
Let $E$ be an elliptic curve over $\dQ$ with discriminant $\Delta$. The 
\emph{partial $L$-function of $E$} is 
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \frac{1}{1-a_p(E) p^{-s} + p^{1-2s}} \text{.}
\]
\end{definition}

Here, $s$ is a complex variable, but this product does converge on the whole 
complex plane. Recall that if $E$ is an elliptic curve over $\dF_p$, the 
characteristic polynomial of the Frobenius $\Phi_E$ acting on $T_\ell E$ is 
$t^2-a_p t + p$. The reverse of this is 
$\det(1-\Phi^\ast t,V_\ell E) = 1-a_p t + p t^2$. It follows that we could have 
defined 
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \frac{1}{\det(1-\Phi_{E,p}^\ast p^{-s}, \h^1(E_p,\dQ_\ell))}
\]
for some prime $\ell\mid \Delta$. There is a way of adding factors at the 
``bad primes'' dividing the discriminant of $E$. We will come back to that later. 

\begin{lemma}
The product defining $L_\Delta(E,s)$ converges absolutely for all $s\in \dC$ 
with $\Re s>\frac 3 2$. Moreover, $L_\Delta(E,s)$ is holomorphic on that 
region. 
\end{lemma}
\begin{proof}
The basic idea is to use the factorization 
$1-a_p t + p t^2 = (1-\omega_{p,1} t)(1-\omega_{p,2}t)$, where  
$|\omega_{p,i}| = p^{1/2}$ by the Weil conjectures. We can write  
\[
  L_\Delta(E,s) = \prod_{p\nmid \Delta} \left(1-\frac{\omega_{p,1}}{p^{1/2}} p^{1/2-s}\right)^{-1}\left( 1-\frac{\omega_{p,2}}{p^{1/2}} p^{1/2-s}\right)^{-1}
\]
Standard arguments (using only the fact that the $\omega_{p,i}$ are $p$-Weil) 
yield the result. 
\end{proof}

Following Euler, we look at $L_\Delta(E,1)$, (which does not exist unless 
$L_\Delta(E,s)$ has some kind of analytic continuation, which we have not 
proved). At least formally (ignoring convergence) we have 
\begin{align*}
  L_\Delta(E,1) &= \prod_{p\nmid \Delta} (1-a_p(E) p^{-1} + p^{-1})^{-1} \\
    &= \prod_{p\nmid \Delta} \frac{p}{p-a_p(E)+1} \\
    &= \prod_{p\nmid \Delta} \frac{p}{\# E(\dF_p)}
\end{align*}
This looks very similar to our definition of the function $\pi_E$. At least 
intuitively, larger $r$ should lead to ``quicker vanishing'' at $s=1$. 

\begin{conjecture}[Birch and Swinnerton-Dyer]
The function $L_\Delta(E,s)$ has an analytic continuation to a neighborhood of 
$s=1$. Moreover, 
\[
  \ord_{s=1} L_\Delta(E,s) = \rank E \text{.}
\]
\end{conjecture}

In other words, the conjecture says that $L_\Delta(E,s)\sim c(s-1)^r$ near 
$s=1$ for some constant $c$. Modern formulations of BSD include a formula for 
$c$. 

Let's define the factors in $L(E,s)$ for primes $p\mid \Delta$. The following 
seems quite ad-hoc without motivation:
%For such a 
%prime, $E$ will have a N\'eron model $\cE_p$ over $\dZ_{(p)}$, and the 
%reduction $(\cE_p)_{\dF_p}$ will either be smooth (good reduction), have a 
%cusp (additive reduction), or a double point (multiplicative reduction). In the 
%latter two cases, the nonsingular locus of $(\cE_p)_{\dF_p}$ is isomorphic (as 
%a group scheme) to $\dG_{a,\dF_p}$ and $\dG_{m,\dF_p}$ respectively. 
%We define the local factor by  
\[
  L_p(E,s)
    = \begin{cases}
        \displaystyle\frac{1}{1-a_p p^{-s} + p^{1-2 s}} & \text{if $E$ has good reduction at $p$}  \\
        \displaystyle\frac{1}{1-a_p p^{-s}} & \text{if $E$ has bad reduction at $p$} \\
  %      1-p^{-s} & \text{if $E$ has nonsplit multiplicative reduction at $p$} \\
  %      1+p^{-s} & \text{if $E$ has split multiplicative reduction at $p$}
      \end{cases}
\]
Here, $a_p=-1$ if $E$ has split multiplicative reduction at $p$, 
$a_p=1$ if $E$ has nonsplit multiplicative reduction, and $a_p=0$ if $E$ has 
additive reduction. 
% a_p=-1 if split, 1 if nonsplit, 0 if additive reduction
This terminology deserves some explanation. Fix a prime $p$. A \emph{minimal 
model} for $E$ at $p$ is an equation $y^2=x^3+a x+b$, where $a,b$ are integral 
over $\dZ_{(p)}$, and such that the descriminant $\Delta=-16(4 a^3+27 b^2)$ has 
minimal $p$-adic valuation among such models. Let $\widetilde E$ be a minimal 
model for $E$. Then $\widetilde E$ is a scheme over $\dZ_{(p)}$, so we can 
consider its reduction $\widetilde E_p=\widetilde E_{\dF_p}$ modulo $p$. If 
$E$ has bad reduction at $p$, $\widetilde E_p$ will be singular, but its 
nonsingular locus $\widetilde E_{p,\text{ns}}$ will be a smooth group scheme 
over $\dF_p$. There are three possibilities for $\widetilde E_{p,\text{ns}}$. 
Either it will be the additive group $\dG_{a,\dF_p}$, in which case we say 
$E$ has \emph{additive reduction at $p$}, or it will be a one-dimensional 
torus (isomorphic to $\dG_{\bar\dF_p}$ after base change). In the second 
case we say $E$ has \emph{split multiplicative reduction at $p$} if 
$\widetilde E_{p,\text{ns}}\simeq \dG_{m,\dF_p}$, and we say $E$ has 
\emph{nonsplit multiplicative reduction at $p$} if 
$\widetilde E_{p,\text{ns}}\not\simeq \dG_{m,\dF_p}$ (it turns out that 
we get isomorphism after base change to a quadratic extension of 
$\dF_p$). See \cite[III.2.5, 2.6]{si06} for a proof and details.  

There is a way of defining the local factors for $L(E,s)$ that is more 
conceptual. Let $\cE$ be the N\'eron model for $E$ over $\dZ$ (this exists by 
\cite[1.4.3]{blr90}). One way of characterizing $\cE$ is by requiring 
that it represent the functor $X\mapsto \hom(X_\dQ,E)$ on smooth varieties over 
$\dZ$. In particular, $\cE$ is a smooth (but not projective) group scheme over 
$\dZ$, so each $\cE_p=\cE_{\dF_p}$ is a group variety over $\dF_p$. If we write 
$\cE_p^\circ$ for the connected component of the identity in $\cE_p$, then by 
\cite[C.15.1, C.16]{si06}, one has 
\[
  a_p = p - \# \widetilde E_{p,\text{ns}}(\dF_p) = p - \# \cE_p^\circ(\dF_p) \text{.}
\]
This yields the following theorem.

\begin{theorem}
Let $E$ be an elliptic curve over $\dQ$, and let $\ell$ be a prime. Then for all 
primes $p\ne \ell$, we have 
\[
  L_p(E,s) = \frac{1}{\det\left(1-\Phi_{p,\ast}\cdot p^{-s}, (T_\ell E)^{I_p}\right)} \text{.}
\]
\end{theorem}
\begin{proof}
Recall that $I_p\subset G_\dQ$ is the inertia subgroup at $p$. If $E$ has good 
reduction at $p$, then the action of $G_\dQ$ on $T_\ell E$ is unramified at 
$p$ (this is the N\'eron-Ogg-Shafarevich criterion, \cite[thm 1]{st68}). In 
that case $T_\ell E \simeq T_\ell \cE_p$, and the result follows from our 
computation in Section \ref{sec:ab-fin-fld} of the characteristic polynomial 
of Frobenius over finite fields. In general, one has 
\[
  T_\ell\cE_p^\circ = (T_\ell E)^{I_p}\text{.}
\]
This is proven in \cite[IX.2.2]{gr72}. Since $T_\ell \cE_p^\circ$ has rank one 
over $\dZ_\ell$, we just need to prove that $\Phi_{p,\ast}$ is multiplication 
by $a_p$ on $T_\ell \cE_p^\circ$. \textbf{(not finished)}
\end{proof}

Much of this generalizes further. Let $k$ be a number field with ring of 
integers $\fo$. Let $A$ be any abelian variety over $k$ with N\'eron model 
$\cA$. For a prime $\fp$ of $\fo$, let $\kappa_\fp=\fo/\fp$ be the residue 
field of $\fp$. The connected component $A_\fp^\circ$ of the reduction 
$A_\fp = \cA_{\kappa_\fp}$ is a smooth commutative group variety over 
$\kappa_\fp$. As such, it admits a maximal subtorus 
$T\subset A_\fp^\circ$, such that the quotient $A_\fp^\circ/T$ is the extension 
of an abelian variety by a unipotent group \cite[IX.2]{gr72}. One says 
$A$ has \emph{good reduction} at a prime $\fp$ if $A_\fp^\circ$ is itself 
abelian. On the other hand, if $A_\fp^\circ/T$ is abelian, the variety 
$A_\fp^\circ$ is semi-abelian, so we say that $A$ has \emph{semistable 
reduction at $\fp$}. If the subtorus of $A_\fp^\circ$ splits over $\kappa_\fp$ 
we say that $A$ has \emph{split semistable reduction} at $\fp$, otherwise it 
has \emph{nonsplit semistable reduction} at $\fp$. 
For elliptic curves, semistable reduction is equivalent to multiplicative 
reduction. 

For each finite place $\fp$ of $k$, choose a prime $\ell$ not dividing $\fp$ 
and put 
\[
  L_\fp(A,s) = \frac{1}{\det\left(1-\Phi_{\fp,\ast} \cdot (N\fp)^{-s}, (T_\ell A)^{I_\fp}\right)} \text{.}
\]
The global $L$-function of $A$ is the product of its local pieces:
\[
  L(A,s) = \prod_\fp L_\fp(A,s) \text{.}
\]
The \emph{Bloch-Kato conjecture} (which makes sense in much more generality -- 
arbitrary pure motives) predicts the order of vanishing of 
$L(A,s)$ at $1$, as well as the leading term in its Taylor expansion at 
$1$. 


%Generally, 
%\[
%  L_p(E,1) = \frac{p}{\# E_{p,\text{ns}}(E_p)}
%\]





\section{More BSD}

Let $E$ be an elliptic curve over $\dQ$. We are interested in the rank of 
$E(\dQ)\simeq E(\dQ)_\text{tors}\oplus \dZ^r$. In particular, we would like to 
relate $r$ to the partial $L$-function 
\[
  L(E,s) = \prod_{p\text{ good}} \frac{1}{1-a_p p^{-s} + p (p^{-s})^2} \cdot \prod_{p\text{ bad}} \frac{1}{1-a_p p^{-s}} 
\]
where 
\[
  a_p 
    = \begin{cases}
        p+1-\# E(\dF_p) & \text{if $E$ has good reduction at $p$} \\
        0               & \text{if $E$ has additive reduction at $p$} \\
        1               & \text{if $E$ has split multiplicative reduction at $p$} \\
        -1              & \text{if $E$ has nonsplit multiplicative reduction at $p$}
      \end{cases}
\]
The product for $L(E,s)$ converges absolutely for all $s\in \dC$ with 
$\Re (s)>\frac 3 2$. Let $N$ be the \emph{conductor} of $E$, i.e. 
\[
  N - \prod_p p^{f_p}
\]
where 
\[
  f_p = 
    \begin{cases} 
      0 & \text{good at $p$} \\ 
      1 & \text{ if mult} \\
       2+\delta_p & \text{$\delta_p=0$ if $p\geqslant 5$} 
       \end{cases}
\]
(\textbf{define the conductor in generality -- maybe need Swan conductor})

\begin{theorem}
The function $L(E,s)$ has an analytic continuation to all of $\dC$. It 
satisfies a functional equation: there exists $\omega\in \{\pm 1\}$ such that 
\[
  \Lambda(s) = \omega \Lambda(2-s)
\]
where $\Lambda(s) = N^{s/2} (2\pi)^{-s} \Gamma(s) L(E,s)$. 
\end{theorem}

The constants $N$ and $\omega$ are easily computed. They are a product of local 
factors, so in particular no analysis is needed to find their values. 

We can expand the product formula for $L(E,s)$ to get a Dirichlet series 
\[
  L(E,s) = \sum_{n\geqslant 1} \frac{a_n}{n^s} \qquad (a_n\in \dZ)
\]
This is consistent with our earlier definition of $a_p$. Moreover, if 
$(m,n)=1$, then $a_{mn}=a_m a_n$. If $n\geqslant 2$, then 
\[
  a_{p^n} = a_p a_{p^{n-1}} - p a_{p^{n-2}} \text{.}
\]
Define the Fourier series 
\[
  f(z) = \sum_{n\geqslant 1} a_n e^{2\pi i n z} = \sum a_n q^n
\]
where as usual $q=e^{2\pi i z}$ and $z$ ranges over the upper half-plane 
$\fh=\{z\in \dC:\Im z>0\}$. 

\begin{theorem}[Wiles, Taylor-Wiles, Breuil-Conrad-Diamond-Taylor]
The function $f$ is a cusp form of weight $2$ and level $N$. Moreover, $f$ is 
an eigenform (eigenvector for all Hecke operators). 
\end{theorem}

(\textbf{explain / define everything})

This is the Taniyama-Shimura conjecture. Recall that $SL(2,\dZ)$ acts on $\fh$ 
via fractional linear transformations:
\[
  \begin{pmatrix} a & b \\ c & d\end{pmatrix}\cdot z = \frac{a z+b}{c z+d}
\]
Let $\eta=f(z)dz$, this is a complex one-form on $\fh$. If 
$\gamma=\smat a b c d$, then 
\[
  \gamma^\ast \eta = f(\gamma z)d(\gamma z) = f(\gamma z)(c z+d)^{-2} dz 
\]
We say a function $f:\fh\to \dC$ is a \emph{weak modular form} of level $N$ and 
weight $2$ if it is holomorphic and $f(z)\, dz$ is invariant under the action of 
\[
  \Gamma_0(N) = \left\{\gamma \in SL(2,\dZ) : \gamma \equiv \begin{pmatrix} \ast & \ast \\ 0 & \ast \end{pmatrix} \mod N\right\}
\]
In other words, for $A=\smat a b c d\in\Gamma_0(N)$, one has 
\[
  f\left(\frac{a z+b}{c z+d}\right) = (c z+d)^{-2} f(z) \text{.}
\]
We an consider the Riemann surface $\fh/\Gamma_0(N)$. It is not compact, but we 
denote its compactification (formed by adding finitely many cusps) by 
$X_0(N)^\text{an}$. We say $f$ is a \emph{cusp form} if the differential 
$f(z) dz$ vanishes on the cusps of $X_0(N)^\text{an}$. 

For a modular form $f$, we can look at its Mellin transform 
\[
  \int_0^\infty f(i t) t^s\, \frac{dt}{t}  = \sum_{n\geqslant 1} a_n \int_0^\infty e^{-2\pi n t} t^s\, \frac{dt}{t}
\]
Making the substitution $u=2\pi n t$, we get 
\[
  \sum_{n\geqslant 1} a_n \frac{1}{(2\pi n)^s} \int_0^\infty e^{-u} u^s\, \frac{du}{u}
    = (2\pi)^{-s} \Gamma(s) \sum_{n\geqslant 1} \frac{a_n}{n^s} \qquad (= (2\pi)^{-s} \Gamma(s) L(E,s) \text{ if $f$ comes from an elliptic curve}
\]
The function $\sum a_n n^{-s}$ (coming from a modular form $f$) has an analytic 
continuation and a functional equation by a theorem of Hecke. 

(Converse: given $f=\sum a_n q^n$ with $a_n\in \dQ$, can construct elliptic curve 
$E_f$ over $\dQ$\ldots Eichler-Shimura: summarize and cite sources (Conrad)\ldots)

Back to BSD. Let $E$ be an elliptic curve over $\dQ$ with rank $r$, and 
analytic rank 
\[
  r_\text{an} = \ord_{s=1} L(E,s)
\]
By the previous discussion, $L(E,s)$ has an analytic continuation to $s=1$, so 
this is well-defined. As stated earlier, one version of BSD is that 
$r=r_\text{an}$. 

From the functional equation, we get $(-1)^{r_\text{an}}=\omega$. The 
\emph{parity conjecture} is that $r\equiv r_\text{an}\pmod 2$. The better 
variant is that $(-1)^r=\omega$. Since $\omega$ can be computed without 
dealing with $L(E,s)$, the parity can be approached computationally. The parity 
conjecture is a theorem whenever $\sha(E)$ is finite. \textbf{(cite source for 
this})

\begin{theorem}[Kolyvagin, Gross-Zagier]
If $r_\textnormal{an}\leqslant 1$, then $r=r_\textnormal{an}$ and $\sha(E)$ is 
finite. 
\end{theorem}
\begin{proof}
(\textbf{cite source})
\end{proof}

One can compute $L(E,s)$ to arbitrary precision. In particular, we can look at 
$L(E,1)$. It turns out that 
\[
  L(E,1) = (1+\omega) \sum_{n\geqslant 1} \frac{a_n}{n} e^{-2\pi n/\sqrt N}
\]
If $\omega=-1$, then $L(E,1)=0$, and it turns out that 
\[
  L'(E,1) = 2 \sum_{n\geqslant 1} \frac{a_n}{n} E_1(\frac{2\pi n}{\sqrt N})
\]
where 
\[
  E_1(x) = \int_x^\infty e^{-t}\, \frac{dt}{t} \text{.}
\]

\begin{example}
Let $E$ be the elliptic curve $y^2=x^3+875 x$ over $\dQ$. We can compute 
$L(E,1) = -3.9\ldots$. In particular, $L(E,1)\ne 0$, which implies 
$r_\text{an}=0$. The above theorem tells us that $r=0$, so 
$E(\dQ)=E(\dQ)_\text{tors}=\{O,(0,0)\}$. 
\end{example}

\begin{example}
Let $E$ be the elliptic curve $y^2=x^3+877 x$ over $\dQ$. It turns out that 
$L(E,1) = 0.000\ldots$. This does \emph{not} imply $L(E,1) = 0$. We can 
compute $\omega=-1$, which means $r_\text{an}$ is odd. Thus we cannot have 
$L(E,1) = 0$. The BSD conjecture would imply $E$ has rank at least one. One 
can compute $L'(E,1) = 32.7\dots\ne 0$. In particular, 
$r_\text{an}\leqslant 1$, so the above theorem tells us $r=1$. In other words, 
$E(\dQ)\simeq \dZ/2\oplus \dZ$, hence $E(\dQ)$ is infinite. 
\end{example}






\bibliographystyle{amsplain}
\bibliography{7390-sources}

\end{document}
